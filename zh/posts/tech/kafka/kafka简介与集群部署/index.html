<!doctype html><html lang=zh dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Kafka简介与集群部署 | WZ's Blog</title>
<meta name=keywords content><meta name=description content="一、Kafka 简介： Apache Kafka 是一个开源的分布式事件流平台，最初由 LinkedIn 开发，后来成为 Apache 软件基金会的顶级项目。它主要用于处理实时数据流，将数据从一个地方传输到另一个地方。Kafka 的设计理念是基于发布订阅模型，通过使用主题（topics）来组织和分类数据流。 Kafka 具有以下主要组件： Produc"><meta name=author content="wz"><link rel=canonical href=https://senmer.github.io/zh/posts/tech/kafka/kafka%E7%AE%80%E4%BB%8B%E4%B8%8E%E9%9B%86%E7%BE%A4%E9%83%A8%E7%BD%B2/><link crossorigin=anonymous href=/assets/css/stylesheet.5a2b6d77cc78ad18bcb4914c5c639c7ce5ab55e956c461d4310747892b3f50c2.css integrity="sha256-Wittd8x4rRi8tJFMXGOcfOWrVelWxGHUMQdHiSs/UMI=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script><link rel=icon href=https://senmer.github.io/img/Q.gif><link rel=icon type=image/png sizes=16x16 href=https://senmer.github.io/img/Q.gif><link rel=icon type=image/png sizes=32x32 href=https://senmer.github.io/img/Q.gif><link rel=apple-touch-icon href=https://senmer.github.io/img/Q.gif><link rel=mask-icon href=https://senmer.github.io/img/Q.gif><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script defer src=https://unpkg.com/mermaid@8.8.1/dist/mermaid.min.js></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css><script src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script><script src=https://cdn.jsdelivr.net/npm/jquery@3.6.3/dist/jquery.min.js></script><script>var _hmt=_hmt||[];(function(){var e,t=document.createElement("script");t.src="https://hm.baidu.com/hm.js?4d7c4710a089d70b71310f0e1ec7681b",e=document.getElementsByTagName("script")[0],e.parentNode.insertBefore(t,e)})()</script><meta property="og:title" content="Kafka简介与集群部署"><meta property="og:description" content="一、Kafka 简介： Apache Kafka 是一个开源的分布式事件流平台，最初由 LinkedIn 开发，后来成为 Apache 软件基金会的顶级项目。它主要用于处理实时数据流，将数据从一个地方传输到另一个地方。Kafka 的设计理念是基于发布订阅模型，通过使用主题（topics）来组织和分类数据流。 Kafka 具有以下主要组件： Produc"><meta property="og:type" content="article"><meta property="og:url" content="https://senmer.github.io/zh/posts/tech/kafka/kafka%E7%AE%80%E4%BB%8B%E4%B8%8E%E9%9B%86%E7%BE%A4%E9%83%A8%E7%BD%B2/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-09-01T10:26:01+08:00"><meta property="article:modified_time" content="2023-09-01T10:26:01+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Kafka简介与集群部署"><meta name=twitter:description content="一、Kafka 简介： Apache Kafka 是一个开源的分布式事件流平台，最初由 LinkedIn 开发，后来成为 Apache 软件基金会的顶级项目。它主要用于处理实时数据流，将数据从一个地方传输到另一个地方。Kafka 的设计理念是基于发布订阅模型，通过使用主题（topics）来组织和分类数据流。 Kafka 具有以下主要组件： Produc"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"📚文章","item":"https://senmer.github.io/zh/posts/"},{"@type":"ListItem","position":2,"name":"👨🏻‍💻 技术","item":"https://senmer.github.io/zh/posts/tech/"},{"@type":"ListItem","position":3,"name":"Kafka简介与集群部署","item":"https://senmer.github.io/zh/posts/tech/kafka/kafka%E7%AE%80%E4%BB%8B%E4%B8%8E%E9%9B%86%E7%BE%A4%E9%83%A8%E7%BD%B2/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Kafka简介与集群部署","name":"Kafka简介与集群部署","description":"一、Kafka 简介： Apache Kafka 是一个开源的分布式事件流平台，最初由 LinkedIn 开发，后来成为 Apache 软件基金会的顶级项目。它主要用于处理实时数据流，将数据从一个地方传输到另一个地方。Kafka 的设计理念是基于发布订阅模型，通过使用主题（topics）来组织和分类数据流。 Kafka 具有以下主要组件： Produc","keywords":[""],"articleBody":"一、Kafka 简介： Apache Kafka 是一个开源的分布式事件流平台，最初由 LinkedIn 开发，后来成为 Apache 软件基金会的顶级项目。它主要用于处理实时数据流，将数据从一个地方传输到另一个地方。Kafka 的设计理念是基于发布订阅模型，通过使用主题（topics）来组织和分类数据流。\nKafka 具有以下主要组件：\nProducer（生产者）： 用于将数据发布到 Kafka 主题，这些数据可以是日志、事件、指标等。\nBroker： Kafka 集群由多个 Broker 组成，每个 Broker 是一个独立的服务器，负责存储数据和处理数据流。\nTopic（主题）： 数据流被组织成主题，生产者将数据发布到主题，消费者从主题订阅数据。\nConsumer（消费者）： 消费者从主题订阅数据，并进行相应的处理。消费者可以以不同的消费组（Consumer Group）来组织，以实现水平扩展和并行处理。\nZookeeper： 虽然 Kafka 从 0.10 版本开始逐步减少对 Zookeeper 的依赖，但在之前的版本中，Zookeeper 用于管理 Kafka 集群的元数据和状态。\n二、Kafka 使用场景： 实时数据流处理： Kafka 可以用于构建实时数据流处理平台，用于收集、传输和处理大量的实时数据，如日志、事件、传感器数据等。\n日志收集和分析： 很多组织使用 Kafka 来收集分布在不同系统上的日志数据，并将其传输到集中的存储或分析系统中。\n事件驱动架构： Kafka 可以作为事件驱动架构的核心，不同的服务可以通过发布和订阅事件来实现解耦和扩展。\n指标和监控数据传输： Kafka 可以用于传输各种系统指标和监控数据，以便进行实时监控和分析。\n流式 ETL（Extract, Transform, Load）： Kafka 可以用作数据源和数据目标，支持流式 ETL 过程，使数据在不同系统之间流动和转换。\n消息队列： Kafka 可以作为高吞吐量的消息队列，用于在不同的应用程序和服务之间传递消息。\n日志压缩存储： Kafka 可以用于长期存储数据，比如保存历史事件和数据备份。\n总之，Kafka 在处理实时数据流、构建事件驱动架构以及实现可靠的数据传输方面具有广泛的应用场景。它的高吞吐量、可扩展性和持久性特征使其成为许多实时应用和大数据处理场景的理想选择。\n三、Kafka 集群部署 3.1 实验环境 注意：以下三个节点已经提前部署了 zookeeper 集群（Kafka 集群依赖 zookeeper ）\n主机名 IP 系统 配置 kafka-01 10.0.0.11 CentOS 7.6 1U 2G kafka-02 10.0.0.12 CentOS 7.6 1U 2G kafka-03 10.0.0.13 CentOS 7.6 1U 2G 3.2 配置 Java 环境 所有节点执行：\nyum install java-1.8.0-openjdk -y java -version 3.3 下载并解压安装包 下载地址：Apache Kafka\n所有节点执行：\ncd /usr/local/src wget https://archive.apache.org/dist/kafka/2.1.0/kafka_2.12-2.1.0.tgz tar xf kafka_2.12-2.1.0.tgz ln -sv /usr/local/src/kafka_2.12-2.1.0 /usr/local/kafka cd /usr/local/kafka/ # 根据需要修改配置文件 cat \u003e config/server.properties \u003c\u003c EOF broker.id=0 num.network.threads=3 num.io.threads=8 socket.send.buffer.bytes=102400 socket.receive.buffer.bytes=102400 socket.request.max.bytes=104857600 log.dirs=/usr/local/kafka/kafka-logs num.partitions=1 num.recovery.threads.per.data.dir=1 offsets.topic.replication.factor=1 transaction.state.log.replication.factor=1 transaction.state.log.min.isr=1 log.retention.hours=168 log.segment.bytes=1073741824 log.retention.check.interval.ms=300000 zookeeper.connect=localhost:2181 zookeeper.connection.timeout.ms=6000 group.initial.rebalance.delay.ms=0 EOF 参数解释：\n这是一个 Kafka Broker 的配置示例，其中包含了一些常见的配置项。下面逐一解释每个配置项的含义：\nbroker.id=0： 设置 Broker 的唯一标识符。在一个 Kafka 集群中，每个 Broker 都应该有一个独一无二的 ID。 num.network.threads=3： 指定处理网络请求的线程数，用于接收和处理客户端连接和请求。 num.io.threads=8： 指定执行 I/O 操作的线程数，用于处理磁盘读写等操作。 socket.send.buffer.bytes=102400： 设置套接字发送缓冲区的大小，以字节为单位。 socket.receive.buffer.bytes=102400： 设置套接字接收缓冲区的大小，以字节为单位。 socket.request.max.bytes=104857600： 设置单个请求的最大字节数，用于限制单个请求的大小。 log.dirs=/usr/local/kafka/kafka-logs： 指定 Kafka 日志文件的存储路径。Kafka 会将主题数据以日志文件的形式存储在这些目录下。 num.partitions=1： 设置默认主题的分区数。每个主题可以被分为多个分区，这个配置项定义了新建主题时的默认分区数。 num.recovery.threads.per.data.dir=1： 指定在每个数据目录上运行的恢复线程数，用于在 Broker 启动时进行数据恢复。 offsets.topic.replication.factor=1： 设置存储消费者偏移量信息的内部主题的复制因子。这个值定义了偏移量信息的冗余备份数。 transaction.state.log.replication.factor=1： 设置存储事务状态的内部主题的复制因子。 transaction.state.log.min.isr=1： 设置事务状态日志的最小副本同步数。如果可用的副本数量低于这个值，就不允许写入事务状态。 log.retention.hours=168： 设置日志文件的保留时间，以小时为单位。超过这个时间的日志文件将被自动删除。 log.segment.bytes=1073741824： 设置日志段（log segment）的最大大小，以字节为单位。一旦日志段达到这个大小，Kafka 将创建一个新的日志段。 log.retention.check.interval.ms=300000： 设置日志保留策略的检查间隔，以毫秒为单位。Kafka 将在这个时间间隔内检查是否需要删除过期的日志文件。 zookeeper.connect=localhost:2181： 指定 Zookeeper 的连接地址，用于管理 Kafka 集群的元数据和状态。 zookeeper.connection.timeout.ms=6000： 设置与 Zookeeper 的连接超时时间，以毫秒为单位。 group.initial.rebalance.delay.ms=0： 设置消费者组初始再平衡的延迟时间，以毫秒为单位。设置为0表示消费者加入消费者组后立即进行再平衡。 这些配置项是 Kafka 集群中的 Broker 部分的配置，它们可以根据需求进行调整以满足性能、可靠性和资源管理等方面的要求。\n3.3 修改集群配置 kafka-01 执行：\n# 配置集群 ID sed -i 's/broker\\.id=0/broker\\.id=1/g' config/server.properties # 修改服务监听地址，默认是localhost:9092 echo \"listeners=PLAINTEXT://10.0.0.11:9092\" \u003e\u003e config/server.properties kafka-02 执行：\nsed -i 's/broker\\.id=0/broker\\.id=2/g' config/server.properties echo \"listeners=PLAINTEXT://10.0.0.12:9092\" \u003e\u003e config/server.properties kafka-03 执行：\nsed -i 's/broker\\.id=0/broker\\.id=3/g' config/server.properties echo \"listeners=PLAINTEXT://10.0.0.13:9092\" \u003e\u003e config/server.properties 3.4 启动服务 zookeeper-01 执行：\n# 启动服务 cd /usr/local/kafka/ bin/kafka-server-start.sh -daemon config/server.properties #查看端口 [root@kafka-01 kafka]# ss -ntl | grep 9092 LISTEN 0 50 :::9092 :::* zookeeper-02 执行：\ncd /usr/local/kafka/ bin/kafka-server-start.sh -daemon config/server.properties #查看端口 [root@kafka-01 kafka]# ss -ntl | grep 9092 LISTEN 0 50 :::9092 :::* zookeeper-03 执行：\ncd /usr/local/kafka/ bin/kafka-server-start.sh -daemon config/server.properties #查看端口 [root@kafka-01 kafka]# ss -ntl | grep 9092 LISTEN 0 50 :::9092 :::* 四、Kafka 数据读写 Kafka自带了一些用于操作和管理Kafka集群的Shell脚本。以下是一些常用的Kafka自带Shell脚本示例：\n1. 创建主题：\n使用kafka-topics.sh脚本创建一个名为\"test-topic\"的主题，具有3个分区和1个副本：\n./kafka-topics.sh --create --topic test-topic --zookeeper localhost:2181 --partitions 3 --replication-factor 1 2. 发送消息：\n使用kafka-console-producer.sh脚本发送消息到\"test-topic\"主题：\n[root@kafka-01 bin]# ./kafka-console-producer.sh --topic test-topic --broker-list localhost:9092 OpenJDK 64-Bit Server VM warning: If the number of processors is expected to increase from one, then you should configure the number of parallel GC threads appropriately using -XX:ParallelGCThreads=N \u003ehello \u003eworld \u003eend \u003e^C 3. 接收消息：\n使用kafka-console-consumer.sh脚本从\"test-topic\"主题消费消息：\n[root@kafka-01 bin]# ./kafka-consoconsumer.sh --topic test-topic --bootstrap-server localhost:9092 --from-beginning OpenJDK 64-Bit Server VM warning: If the number of processors is expected to increase from one, then you should configure the number of parallel GC threads appropriately using -XX:ParallelGCThreads=N hello world end 4. 查看主题列表：\n查看当前Kafka集群中的主题列表：\n./kafka-topics.sh --list --zookeeper localhost:2181 5. 查看消费者组列表：\n查看当前消费者组的列表：\n./kafka-consumer-groups.sh --list --bootstrap-server localhost:9092 6. 描述主题：\n获取关于主题\"test-topic\"的信息，如分区和副本分布情况：\n./kafka-topics.sh --describe --topic test-topic --zookeeper localhost:2181 7. 查看消费者组偏移量：\n查看消费者组\"my-group\"在主题\"test-topic\"上的消费偏移量：\n./kafka-consumer-groups.sh --describe --group my-group --bootstrap-server localhost:9092 当涉及删除主题和创建消费者组时，你可以使用Kafka自带的Shell脚本来执行这些操作。以下是删除主题和创建消费者组的示例：\n8. 删除主题：\n使用kafka-topics.sh脚本删除名为\"test-topic\"的主题：\n./kafka-topics.sh --delete --topic test-topic --zookeeper localhost:2181 请注意，删除主题会永久删除该主题的所有数据和配置，请谨慎操作。\n9. 创建消费者组：\n使用kafka-consumer-groups.sh脚本创建一个名为\"my-consumer-group\"的消费者组，并将其订阅到\"test-topic\"主题：\n./kafka-consumer-groups.sh --bootstrap-server localhost:9092 --create --topic test-topic --group my-consumer-group 附录 Kafka 中文文档 - ApacheCN\nKafka基本原理详解（超详细！）kafka工作原理\u003c一蓑烟雨任平生\u003e的博客-CSDN博客\n学习 Kafka 入门知识看这一篇就够了！（万字长文）-腾讯云开发者社区-腾讯云 (tencent.com)\n真的，搞懂 Kafka 看这一篇就够了！ - 掘金 (juejin.cn)\n","wordCount":"3352","inLanguage":"zh","datePublished":"2023-09-01T10:26:01+08:00","dateModified":"2023-09-01T10:26:01+08:00","author":[{"@type":"Person","name":"wz"}],"mainEntityOfPage":{"@type":"WebPage","@id":"https://senmer.github.io/zh/posts/tech/kafka/kafka%E7%AE%80%E4%BB%8B%E4%B8%8E%E9%9B%86%E7%BE%A4%E9%83%A8%E7%BD%B2/"},"publisher":{"@type":"Organization","name":"WZ's Blog","logo":{"@type":"ImageObject","url":"https://senmer.github.io/img/Q.gif"}}}</script></head><body id=top><script>(function(){let e,t=new RegExp("(^| )change-themes=([^;]*)(;|$)");(e=document.cookie.match(t))||((new Date).getHours()>=19||(new Date).getHours()<6?(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark")):(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")))})(),localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://senmer.github.io/zh/ accesskey=h title="WZ's Blog (Alt + H)"><img src=https://senmer.github.io/img/Q.gif alt=logo aria-label=logo height=35>WZ's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://senmer.github.io/zh/search title="🔍 搜索 (Alt + /)" accesskey=/><span>🔍 搜索</span></a></li><li><a href=https://senmer.github.io/zh/ title="🏠 主页"><span>🏠 主页</span></a></li><li><a href=https://senmer.github.io/zh/posts/tech title="📚 文章"><span>📚 文章</span></a></li><li><a href=https://senmer.github.io/zh/categories/ title="🧩 分类"><span>🧩 分类</span></a></li><li><a href=https://senmer.github.io/zh/archives/ title="⏱️ 时间轴"><span>⏱️ 时间轴</span></a></li><li><a href=https://senmer.github.io/zh/about title="🙋🏻‍♂️ 关于"><span>🙋🏻‍♂️ 关于</span></a></li><li><a href=https://senmer.github.io/zh/links title="🤝 友链"><span>🤝 友链</span></a></li></ul></nav></header><main class="main page"><style>i[id*=post_meta_style]{display:flex;align-items:center;margin:0 0 10px}</style><article class=post-single><div id=single-content><header class=post-header><div class=breadcrumbs><a href=https://senmer.github.io/zh/>🏠 主页</a>&nbsp;»&nbsp;<a href=https://senmer.github.io/zh/posts/>📚文章</a>&nbsp;»&nbsp;<a href=https://senmer.github.io/zh/posts/tech/>👨🏻‍💻 技术</a></div><h1 class=post-title>Kafka简介与集群部署</h1><div class=post-meta><style>i[id*=post_meta_style]{display:flex;align-items:center;margin:0 0 10px}.parent-post-meta{display:flex;flex-wrap:wrap;opacity:.8}</style><span class=parent-post-meta><span id=post_meta_style_1><span class="fa fa-calendar-check-o"></span>
<span>2023-09-01
&nbsp;&nbsp;
</span></span><span id=post_meta_style_3><span class="fa fa-file-word-o"></span>
<span>3352字
&nbsp;&nbsp;
</span></span><span id=post_meta_style_4><span class="fa fa-clock-o"></span>
<span>7分钟
&nbsp;&nbsp;
</span></span><span id=post_meta_style_5><span class="fa fa-user-o"></span>
<span>wz
&nbsp;&nbsp;
</span></span><span id=post_meta_style_6><span class="fa fa-tags" style=opacity:.8></span>
<span><span class=post-tags-meta></span></span></span></span><span style=opacity:.8><span id=post_meta_style_7>&nbsp;&nbsp;
<span class="fa fa-eye"></span>
<span><span id=busuanzi_container_page_pv><span id=busuanzi_value_page_pv></span></span>
&nbsp;&nbsp;
</span></span><span id=post_meta_style_8><span class="fa fa-commenting-o"></span>
<span><script src=https://cdn.staticfile.org/twikoo/1.6.16/twikoo.all.min.js></script><script>let url=document.documentURI,dnsUrl="https://senmer.github.io/",urlSplit=url.split(dnsUrl),finalUrl=urlSplit[1];finalUrl[0]!=="/"&&(finalUrl="/"+finalUrl),twikoo.getCommentsCount({envId:"https://hugo-api-khaki.vercel.app/# 填写自己的twikoo id",region:null,urls:[finalUrl],includeReply:!1}).then(function(e){let t=e[0].count;const n=document.getElementById("comment_count");n.innerText=t}).catch(function(e){console.error(e)})</script><span id=comment_count></span></span></span></span></div></header><aside id=toc-container class="toc-container wide"><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>目录</span></summary><div class=inner><ul><li><a href=#%e4%b8%80kafka-%e7%ae%80%e4%bb%8b aria-label="一、Kafka 简介：">一、Kafka 简介：</a></li><li><a href=#%e4%ba%8ckafka-%e4%bd%bf%e7%94%a8%e5%9c%ba%e6%99%af aria-label="二、Kafka 使用场景：">二、Kafka 使用场景：</a></li><li><a href=#%e4%b8%89kafka-%e9%9b%86%e7%be%a4%e9%83%a8%e7%bd%b2 aria-label="三、Kafka 集群部署">三、Kafka 集群部署</a><ul><li><a href=#31-%e5%ae%9e%e9%aa%8c%e7%8e%af%e5%a2%83 aria-label="3.1 实验环境">3.1 实验环境</a></li><li><a href=#32-%e9%85%8d%e7%bd%ae-java-%e7%8e%af%e5%a2%83 aria-label="3.2 配置 Java 环境">3.2 配置 Java 环境</a></li><li><a href=#33-%e4%b8%8b%e8%bd%bd%e5%b9%b6%e8%a7%a3%e5%8e%8b%e5%ae%89%e8%a3%85%e5%8c%85 aria-label="3.3 下载并解压安装包">3.3 下载并解压安装包</a></li><li><a href=#33-%e4%bf%ae%e6%94%b9%e9%9b%86%e7%be%a4%e9%85%8d%e7%bd%ae aria-label="3.3 修改集群配置">3.3 修改集群配置</a></li><li><a href=#34-%e5%90%af%e5%8a%a8%e6%9c%8d%e5%8a%a1 aria-label="3.4 启动服务">3.4 启动服务</a></li></ul></li><li><a href=#%e5%9b%9bkafka-%e6%95%b0%e6%8d%ae%e8%af%bb%e5%86%99 aria-label="四、Kafka 数据读写">四、Kafka 数据读写</a></li><li><a href=#%e9%99%84%e5%bd%95 aria-label=附录>附录</a></li></ul></div></details></div></aside><script>let activeElement,elements;window.addEventListener("DOMContentLoaded",function(){checkTocPosition(),elements=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]"),activeElement=elements[0];const t=encodeURI(activeElement.getAttribute("id")).toLowerCase();document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active")},!1),window.addEventListener("resize",function(){checkTocPosition()},!1),window.addEventListener("scroll",()=>{activeElement=Array.from(elements).find(e=>{if(getOffsetTop(e)-window.pageYOffset>0&&getOffsetTop(e)-window.pageYOffset<window.innerHeight/2)return e})||activeElement,elements.forEach(e=>{const t=encodeURI(e.getAttribute("id")).toLowerCase();e===activeElement?document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active"):document.querySelector(`.inner ul li a[href="#${t}"]`).classList.remove("active")})},!1);const main=parseInt(getComputedStyle(document.body).getPropertyValue("--article-width"),10),toc=parseInt(getComputedStyle(document.body).getPropertyValue("--toc-width"),10),gap=parseInt(getComputedStyle(document.body).getPropertyValue("--gap"),10);function checkTocPosition(){const e=document.body.scrollWidth;e-main-toc*2-gap*4>0?document.getElementById("toc-container").classList.add("wide"):document.getElementById("toc-container").classList.remove("wide")}function getOffsetTop(e){if(!e.getClientRects().length)return 0;let t=e.getBoundingClientRect(),n=e.ownerDocument.defaultView;return t.top+n.pageYOffset}</script><div class=post-content><h2 id=一kafka-简介>一、Kafka 简介：<a hidden class=anchor aria-hidden=true href=#一kafka-简介>#</a></h2><p>Apache Kafka 是一个开源的分布式事件流平台，最初由 LinkedIn 开发，后来成为 Apache 软件基金会的顶级项目。它主要用于处理实时数据流，将数据从一个地方传输到另一个地方。Kafka 的设计理念是基于发布订阅模型，通过使用主题（topics）来组织和分类数据流。</p><p>Kafka 具有以下主要组件：</p><ol><li><p><strong>Producer（生产者）：</strong> 用于将数据发布到 Kafka 主题，这些数据可以是日志、事件、指标等。</p></li><li><p><strong>Broker：</strong> Kafka 集群由多个 Broker 组成，每个 Broker 是一个独立的服务器，负责存储数据和处理数据流。</p></li><li><p><strong>Topic（主题）：</strong> 数据流被组织成主题，生产者将数据发布到主题，消费者从主题订阅数据。</p></li><li><p><strong>Consumer（消费者）：</strong> 消费者从主题订阅数据，并进行相应的处理。消费者可以以不同的消费组（Consumer Group）来组织，以实现水平扩展和并行处理。</p></li><li><p><strong>Zookeeper：</strong> 虽然 Kafka 从 0.10 版本开始逐步减少对 Zookeeper 的依赖，但在之前的版本中，Zookeeper 用于管理 Kafka 集群的元数据和状态。</p></li></ol><h2 id=二kafka-使用场景>二、Kafka 使用场景：<a hidden class=anchor aria-hidden=true href=#二kafka-使用场景>#</a></h2><ol><li><p><strong>实时数据流处理：</strong> Kafka 可以用于构建实时数据流处理平台，用于收集、传输和处理大量的实时数据，如日志、事件、传感器数据等。</p></li><li><p><strong>日志收集和分析：</strong> 很多组织使用 Kafka 来收集分布在不同系统上的日志数据，并将其传输到集中的存储或分析系统中。</p></li><li><p><strong>事件驱动架构：</strong> Kafka 可以作为事件驱动架构的核心，不同的服务可以通过发布和订阅事件来实现解耦和扩展。</p></li><li><p><strong>指标和监控数据传输：</strong> Kafka 可以用于传输各种系统指标和监控数据，以便进行实时监控和分析。</p></li><li><p><strong>流式 ETL（Extract, Transform, Load）：</strong> Kafka 可以用作数据源和数据目标，支持流式 ETL 过程，使数据在不同系统之间流动和转换。</p></li><li><p><strong>消息队列：</strong> Kafka 可以作为高吞吐量的消息队列，用于在不同的应用程序和服务之间传递消息。</p></li><li><p><strong>日志压缩存储：</strong> Kafka 可以用于长期存储数据，比如保存历史事件和数据备份。</p></li></ol><p>总之，Kafka 在处理实时数据流、构建事件驱动架构以及实现可靠的数据传输方面具有广泛的应用场景。它的高吞吐量、可扩展性和持久性特征使其成为许多实时应用和大数据处理场景的理想选择。</p><h2 id=三kafka-集群部署>三、Kafka 集群部署<a hidden class=anchor aria-hidden=true href=#三kafka-集群部署>#</a></h2><h3 id=31-实验环境>3.1 实验环境<a hidden class=anchor aria-hidden=true href=#31-实验环境>#</a></h3><p><strong>注意：以下三个节点已经提前部署了 zookeeper 集群</strong>（Kafka 集群依赖 zookeeper ）</p><table><thead><tr><th>主机名</th><th>IP</th><th>系统</th><th>配置</th></tr></thead><tbody><tr><td>kafka-01</td><td>10.0.0.11</td><td>CentOS 7.6</td><td>1U 2G</td></tr><tr><td>kafka-02</td><td>10.0.0.12</td><td>CentOS 7.6</td><td>1U 2G</td></tr><tr><td>kafka-03</td><td>10.0.0.13</td><td>CentOS 7.6</td><td>1U 2G</td></tr></tbody></table><h3 id=32-配置-java-环境>3.2 配置 Java 环境<a hidden class=anchor aria-hidden=true href=#32-配置-java-环境>#</a></h3><p><strong>所有节点执行：</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>yum install java-1.8.0-openjdk -y
</span></span><span style=display:flex><span>java -version
</span></span></code></pre></div><h3 id=33-下载并解压安装包>3.3 下载并解压安装包<a hidden class=anchor aria-hidden=true href=#33-下载并解压安装包>#</a></h3><p><strong>下载地址</strong>：<a href=https://kafka.apache.org/downloads>Apache Kafka</a></p><p><strong>所有节点执行：</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cd /usr/local/src
</span></span><span style=display:flex><span>wget https://archive.apache.org/dist/kafka/2.1.0/kafka_2.12-2.1.0.tgz
</span></span><span style=display:flex><span>tar xf kafka_2.12-2.1.0.tgz
</span></span><span style=display:flex><span>ln -sv /usr/local/src/kafka_2.12-2.1.0 /usr/local/kafka
</span></span><span style=display:flex><span>cd /usr/local/kafka/
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 根据需要修改配置文件</span>
</span></span><span style=display:flex><span>cat &gt; config/server.properties <span style=color:#e6db74>&lt;&lt; EOF
</span></span></span><span style=display:flex><span><span style=color:#e6db74>broker.id=0
</span></span></span><span style=display:flex><span><span style=color:#e6db74>num.network.threads=3
</span></span></span><span style=display:flex><span><span style=color:#e6db74>num.io.threads=8
</span></span></span><span style=display:flex><span><span style=color:#e6db74>socket.send.buffer.bytes=102400
</span></span></span><span style=display:flex><span><span style=color:#e6db74>socket.receive.buffer.bytes=102400
</span></span></span><span style=display:flex><span><span style=color:#e6db74>socket.request.max.bytes=104857600
</span></span></span><span style=display:flex><span><span style=color:#e6db74>log.dirs=/usr/local/kafka/kafka-logs
</span></span></span><span style=display:flex><span><span style=color:#e6db74>num.partitions=1
</span></span></span><span style=display:flex><span><span style=color:#e6db74>num.recovery.threads.per.data.dir=1
</span></span></span><span style=display:flex><span><span style=color:#e6db74>offsets.topic.replication.factor=1
</span></span></span><span style=display:flex><span><span style=color:#e6db74>transaction.state.log.replication.factor=1
</span></span></span><span style=display:flex><span><span style=color:#e6db74>transaction.state.log.min.isr=1
</span></span></span><span style=display:flex><span><span style=color:#e6db74>log.retention.hours=168
</span></span></span><span style=display:flex><span><span style=color:#e6db74>log.segment.bytes=1073741824
</span></span></span><span style=display:flex><span><span style=color:#e6db74>log.retention.check.interval.ms=300000
</span></span></span><span style=display:flex><span><span style=color:#e6db74>zookeeper.connect=localhost:2181
</span></span></span><span style=display:flex><span><span style=color:#e6db74>zookeeper.connection.timeout.ms=6000
</span></span></span><span style=display:flex><span><span style=color:#e6db74>group.initial.rebalance.delay.ms=0
</span></span></span><span style=display:flex><span><span style=color:#e6db74>EOF</span>
</span></span></code></pre></div><p><strong>参数解释：</strong></p><p>这是一个 Kafka Broker 的配置示例，其中包含了一些常见的配置项。下面逐一解释每个配置项的含义：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ini data-lang=ini><span style=display:flex><span><span style=color:#a6e22e>broker.id</span><span style=color:#f92672>=</span><span style=color:#e6db74>0： 设置 Broker 的唯一标识符。在一个 Kafka 集群中，每个 Broker 都应该有一个独一无二的 ID。</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>num.network.threads</span><span style=color:#f92672>=</span><span style=color:#e6db74>3： 指定处理网络请求的线程数，用于接收和处理客户端连接和请求。</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>num.io.threads</span><span style=color:#f92672>=</span><span style=color:#e6db74>8： 指定执行 I/O 操作的线程数，用于处理磁盘读写等操作。</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>socket.send.buffer.bytes</span><span style=color:#f92672>=</span><span style=color:#e6db74>102400： 设置套接字发送缓冲区的大小，以字节为单位。</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>socket.receive.buffer.bytes</span><span style=color:#f92672>=</span><span style=color:#e6db74>102400： 设置套接字接收缓冲区的大小，以字节为单位。</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>socket.request.max.bytes</span><span style=color:#f92672>=</span><span style=color:#e6db74>104857600： 设置单个请求的最大字节数，用于限制单个请求的大小。</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>log.dirs</span><span style=color:#f92672>=</span><span style=color:#e6db74>/usr/local/kafka/kafka-logs： 指定 Kafka 日志文件的存储路径。Kafka 会将主题数据以日志文件的形式存储在这些目录下。</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>num.partitions</span><span style=color:#f92672>=</span><span style=color:#e6db74>1： 设置默认主题的分区数。每个主题可以被分为多个分区，这个配置项定义了新建主题时的默认分区数。</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>num.recovery.threads.per.data.dir</span><span style=color:#f92672>=</span><span style=color:#e6db74>1： 指定在每个数据目录上运行的恢复线程数，用于在 Broker 启动时进行数据恢复。</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>offsets.topic.replication.factor</span><span style=color:#f92672>=</span><span style=color:#e6db74>1： 设置存储消费者偏移量信息的内部主题的复制因子。这个值定义了偏移量信息的冗余备份数。</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>transaction.state.log.replication.factor</span><span style=color:#f92672>=</span><span style=color:#e6db74>1： 设置存储事务状态的内部主题的复制因子。</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>transaction.state.log.min.isr</span><span style=color:#f92672>=</span><span style=color:#e6db74>1： 设置事务状态日志的最小副本同步数。如果可用的副本数量低于这个值，就不允许写入事务状态。</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>log.retention.hours</span><span style=color:#f92672>=</span><span style=color:#e6db74>168： 设置日志文件的保留时间，以小时为单位。超过这个时间的日志文件将被自动删除。</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>log.segment.bytes</span><span style=color:#f92672>=</span><span style=color:#e6db74>1073741824： 设置日志段（log segment）的最大大小，以字节为单位。一旦日志段达到这个大小，Kafka 将创建一个新的日志段。</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>log.retention.check.interval.ms</span><span style=color:#f92672>=</span><span style=color:#e6db74>300000： 设置日志保留策略的检查间隔，以毫秒为单位。Kafka 将在这个时间间隔内检查是否需要删除过期的日志文件。</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>zookeeper.connect</span><span style=color:#f92672>=</span><span style=color:#e6db74>localhost:2181： 指定 Zookeeper 的连接地址，用于管理 Kafka 集群的元数据和状态。</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>zookeeper.connection.timeout.ms</span><span style=color:#f92672>=</span><span style=color:#e6db74>6000： 设置与 Zookeeper 的连接超时时间，以毫秒为单位。</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>group.initial.rebalance.delay.ms</span><span style=color:#f92672>=</span><span style=color:#e6db74>0： 设置消费者组初始再平衡的延迟时间，以毫秒为单位。设置为0表示消费者加入消费者组后立即进行再平衡。</span>
</span></span></code></pre></div><p>这些配置项是 Kafka 集群中的 Broker 部分的配置，它们可以根据需求进行调整以满足性能、可靠性和资源管理等方面的要求。</p><h3 id=33-修改集群配置>3.3 修改集群配置<a hidden class=anchor aria-hidden=true href=#33-修改集群配置>#</a></h3><p><strong>kafka-01 执行：</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># 配置集群 ID</span>
</span></span><span style=display:flex><span>sed -i <span style=color:#e6db74>&#39;s/broker\.id=0/broker\.id=1/g&#39;</span> config/server.properties
</span></span><span style=display:flex><span><span style=color:#75715e># 修改服务监听地址，默认是localhost:9092</span>
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34;listeners=PLAINTEXT://10.0.0.11:9092&#34;</span> &gt;&gt; config/server.properties
</span></span></code></pre></div><p><strong>kafka-02 执行：</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sed -i <span style=color:#e6db74>&#39;s/broker\.id=0/broker\.id=2/g&#39;</span> config/server.properties
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34;listeners=PLAINTEXT://10.0.0.12:9092&#34;</span> &gt;&gt; config/server.properties
</span></span></code></pre></div><p><strong>kafka-03 执行：</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sed -i <span style=color:#e6db74>&#39;s/broker\.id=0/broker\.id=3/g&#39;</span> config/server.properties
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34;listeners=PLAINTEXT://10.0.0.13:9092&#34;</span> &gt;&gt; config/server.properties
</span></span></code></pre></div><h3 id=34-启动服务>3.4 启动服务<a hidden class=anchor aria-hidden=true href=#34-启动服务>#</a></h3><p><strong>zookeeper-01 执行：</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># 启动服务</span>
</span></span><span style=display:flex><span>cd /usr/local/kafka/
</span></span><span style=display:flex><span>bin/kafka-server-start.sh -daemon config/server.properties
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#查看端口</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@kafka-01 kafka<span style=color:#f92672>]</span><span style=color:#75715e># ss -ntl | grep 9092</span>
</span></span><span style=display:flex><span>LISTEN     <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>50</span>          :::9092                    :::*
</span></span></code></pre></div><p><strong>zookeeper-02 执行：</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cd /usr/local/kafka/
</span></span><span style=display:flex><span>bin/kafka-server-start.sh -daemon config/server.properties
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#查看端口</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@kafka-01 kafka<span style=color:#f92672>]</span><span style=color:#75715e># ss -ntl | grep 9092</span>
</span></span><span style=display:flex><span>LISTEN     <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>50</span>          :::9092                    :::*
</span></span></code></pre></div><p><strong>zookeeper-03 执行：</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cd /usr/local/kafka/
</span></span><span style=display:flex><span>bin/kafka-server-start.sh -daemon config/server.properties
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#查看端口</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@kafka-01 kafka<span style=color:#f92672>]</span><span style=color:#75715e># ss -ntl | grep 9092</span>
</span></span><span style=display:flex><span>LISTEN     <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>50</span>          :::9092                    :::*
</span></span></code></pre></div><h2 id=四kafka-数据读写>四、Kafka 数据读写<a hidden class=anchor aria-hidden=true href=#四kafka-数据读写>#</a></h2><p>Kafka自带了一些用于操作和管理Kafka集群的Shell脚本。以下是一些常用的Kafka自带Shell脚本示例：</p><p><strong>1. 创建主题：</strong></p><p>使用<code>kafka-topics.sh</code>脚本创建一个名为"test-topic"的主题，具有3个分区和1个副本：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./kafka-topics.sh --create --topic test-topic --zookeeper localhost:2181 --partitions <span style=color:#ae81ff>3</span> --replication-factor <span style=color:#ae81ff>1</span>
</span></span></code></pre></div><p><strong>2. 发送消息：</strong></p><p>使用<code>kafka-console-producer.sh</code>脚本发送消息到"test-topic"主题：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f92672>[</span>root@kafka-01 bin<span style=color:#f92672>]</span><span style=color:#75715e># ./kafka-console-producer.sh --topic test-topic --broker-list localhost:9092</span>
</span></span><span style=display:flex><span>OpenJDK 64-Bit Server VM warning: If the number of processors is expected to increase from one, <span style=color:#66d9ef>then</span> you should configure the number of parallel GC threads appropriately using -XX:ParallelGCThreads<span style=color:#f92672>=</span>N
</span></span><span style=display:flex><span>&gt;hello
</span></span><span style=display:flex><span>&gt;world      
</span></span><span style=display:flex><span>&gt;end
</span></span><span style=display:flex><span>&gt;^C
</span></span></code></pre></div><p><strong>3. 接收消息：</strong></p><p>使用<code>kafka-console-consumer.sh</code>脚本从"test-topic"主题消费消息：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f92672>[</span>root@kafka-01 bin<span style=color:#f92672>]</span><span style=color:#75715e># ./kafka-consoconsumer.sh --topic test-topic --bootstrap-server localhost:9092 --from-beginning</span>
</span></span><span style=display:flex><span>OpenJDK 64-Bit Server VM warning: If the number of processors is expected to increase from one, <span style=color:#66d9ef>then</span> you should configure the number of parallel GC threads appropriately using -XX:ParallelGCThreads<span style=color:#f92672>=</span>N
</span></span><span style=display:flex><span>hello
</span></span><span style=display:flex><span>world
</span></span><span style=display:flex><span>end
</span></span></code></pre></div><p><strong>4. 查看主题列表：</strong></p><p>查看当前Kafka集群中的主题列表：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./kafka-topics.sh --list --zookeeper localhost:2181
</span></span></code></pre></div><p><strong>5. 查看消费者组列表：</strong></p><p>查看当前消费者组的列表：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./kafka-consumer-groups.sh --list --bootstrap-server localhost:9092
</span></span></code></pre></div><p><strong>6. 描述主题：</strong></p><p>获取关于主题"test-topic"的信息，如分区和副本分布情况：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./kafka-topics.sh --describe --topic test-topic --zookeeper localhost:2181
</span></span></code></pre></div><p><strong>7. 查看消费者组偏移量：</strong></p><p>查看消费者组"my-group"在主题"test-topic"上的消费偏移量：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./kafka-consumer-groups.sh --describe --group my-group --bootstrap-server localhost:9092
</span></span></code></pre></div><p>当涉及删除主题和创建消费者组时，你可以使用Kafka自带的Shell脚本来执行这些操作。以下是删除主题和创建消费者组的示例：</p><p><strong>8. 删除主题：</strong></p><p>使用<code>kafka-topics.sh</code>脚本删除名为"test-topic"的主题：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./kafka-topics.sh --delete --topic test-topic --zookeeper localhost:2181
</span></span></code></pre></div><p>请注意，删除主题会永久删除该主题的所有数据和配置，请谨慎操作。</p><p><strong>9. 创建消费者组：</strong></p><p>使用<code>kafka-consumer-groups.sh</code>脚本创建一个名为"my-consumer-group"的消费者组，并将其订阅到"test-topic"主题：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./kafka-consumer-groups.sh --bootstrap-server localhost:9092 --create --topic test-topic --group my-consumer-group
</span></span></code></pre></div><h2 id=附录>附录<a hidden class=anchor aria-hidden=true href=#附录>#</a></h2><p><a href=https://kafka.apachecn.org/>Kafka 中文文档 - ApacheCN</a></p><p><a href=https://blog.csdn.net/weixin_45366499/article/details/106943229>Kafka基本原理详解（超详细！）<em>kafka工作原理</em>&lt;一蓑烟雨任平生>的博客-CSDN博客</a></p><p><a href=https://cloud.tencent.com/developer/article/1547380>学习 Kafka 入门知识看这一篇就够了！（万字长文）-腾讯云开发者社区-腾讯云 (tencent.com)</a></p><p><a href=https://juejin.cn/post/6963101806402469902>真的，搞懂 Kafka 看这一篇就够了！ - 掘金 (juejin.cn)</a></p></div><div class=post-reward><div style=padding:0;margin:0;width:100%;font-size:16px;text-align:center><div id=QR style=opacity:0><div id=wechat style=display:inline-block><a class=fancybox rel=group><img id=wechat_qr src=https://senmer.github.io/img/wechat_pay.png alt=wechat_pay></a><p>微信</p></div><div id=alipay style=display:inline-block><a class=fancybox rel=group><img id=alipay_qr src=https://senmer.github.io/img/alipay.png alt=alipay></a><p>支付宝</p></div></div><button id=rewardButton onclick='var qr=document.getElementById("QR");qr.style.opacity==="0"?qr.style.opacity="1":qr.style.opacity="0"'>
<span>🧧 鼓励</span></button></div></div><footer class=post-footer><nav class=paginav><a class=prev href=https://senmer.github.io/zh/posts/tech/kubernetes/kubeadm%E9%83%A8%E7%BD%B2k8s%E9%9B%86%E7%BE%A4/><span class=title>« 上一页</span><br><span>Kubeadm部署k8s集群</span>
</a><a class=next href=https://senmer.github.io/zh/posts/tech/zookeeper/zookeeper/><span class=title>下一页 »</span><br><span>Zookeeper</span></a></nav></footer></div><style>.comments_details summary::marker{font-size:20px;content:'👉展开评论';color:var(--content)}.comments_details[open] summary::marker{font-size:20px;content:'👇关闭评论';color:var(--content)}</style><div><details class=comments_details open><summary style=display:none></summary><div id=tcomment></div></details><script src=https://cdn.staticfile.org/twikoo/1.6.16/twikoo.all.min.js></script><script>twikoo.init({envId:"https://hugo-api-khaki.vercel.app/# 填写自己的twikoo id",el:"#tcomment",lang:"zh-CN",region:null,path:window.TWIKOO_MAGIC_PATH||window.location.pathname})</script></div></article></main><footer class=footer><span>Copyright
&copy;
2020-2023
<a href=https://senmer.github.io/zh/ style=color:#939393>WZ's Blog</a>
All Rights Reserved
</span><a href=https://beian.miit.gov.cn/ target=_blank style=color:#939393></a>&nbsp;
<span><a target=_blank href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=null" style=display:inline-block;text-decoration:none;height:20px;color:#939393><img src style="float:left;margin:0 5px 0 0">
</a></span><span id=busuanzi_container><span class="fa fa-user"></span> <span id=busuanzi_value_site_uv></span>
<span class="fa fa-eye"></span> <span id=busuanzi_value_site_pv></span></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><span class=topInner><svg class="topSvg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg><span id=read_progress></span>
</span></a><script>document.addEventListener("scroll",function(){const t=document.getElementById("read_progress"),n=document.documentElement.scrollHeight,s=document.documentElement.clientHeight,o=document.documentElement.scrollTop||document.body.scrollTop;t.innerText=((o/(n-s)).toFixed(2)*100).toFixed(0)})</script><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>let mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>200||document.documentElement.scrollTop>200?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{(function(){document.cookie="change-themes="+escape("false")})(),document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.body.addEventListener("copy",function(e){if(window.getSelection().toString()&&window.getSelection().toString().length>50){let t=e.clipboardData||window.clipboardData;if(t){e.preventDefault();let n=window.getSelection().toString(),s=window.getSelection().toString();t.setData("text/html",n),t.setData("text/plain",s)}}})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const s=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerText="复制";function i(){t.innerText="已复制！",setTimeout(()=>{t.innerText="复制"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){let t=e.textContent;navigator.clipboard.writeText(t),i();return}const n=document.createRange();n.selectNodeContents(e);const s=window.getSelection();s.removeAllRanges(),s.addRange(n);try{document.execCommand("copy"),i()}catch{}s.removeRange(n)});let l=e.className.replaceAll("language-",""),n=document.createElement("div"),a=document.createElement("div"),r=document.createElement("div"),c=document.createElement("div"),o=document.createElement("div");o.innerText=l,n.setAttribute("class","mac-tool"),a.setAttribute("class","mac bb1"),r.setAttribute("class","mac bb2"),c.setAttribute("class","mac bb3"),o.setAttribute("class","language-type"),n.appendChild(a),n.appendChild(r),n.appendChild(c),n.appendChild(o),s.classList.contains("highlight")?(s.appendChild(t),s.appendChild(n)):s.parentNode.firstChild==s||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?(e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t),s.appendChild(n)):(e.parentNode.appendChild(t),s.appendChild(n)))})</script></body></html>