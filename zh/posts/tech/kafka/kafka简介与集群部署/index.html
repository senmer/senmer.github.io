<!doctype html><html lang=zh dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Kafkaç®€ä»‹ä¸é›†ç¾¤éƒ¨ç½² | WZ's Blog</title>
<meta name=keywords content><meta name=description content="ä¸€ã€Kafka ç®€ä»‹ï¼š Apache Kafka æ˜¯ä¸€ä¸ªå¼€æºçš„åˆ†å¸ƒå¼äº‹ä»¶æµå¹³å°ï¼Œæœ€åˆç”± LinkedIn å¼€å‘ï¼Œåæ¥æˆä¸º Apache è½¯ä»¶åŸºé‡‘ä¼šçš„é¡¶çº§é¡¹ç›®ã€‚å®ƒä¸»è¦ç”¨äºå¤„ç†å®æ—¶æ•°æ®æµï¼Œå°†æ•°æ®ä»ä¸€ä¸ªåœ°æ–¹ä¼ è¾“åˆ°å¦ä¸€ä¸ªåœ°æ–¹ã€‚Kafka çš„è®¾è®¡ç†å¿µæ˜¯åŸºäºå‘å¸ƒè®¢é˜…æ¨¡å‹ï¼Œé€šè¿‡ä½¿ç”¨ä¸»é¢˜ï¼ˆtopicsï¼‰æ¥ç»„ç»‡å’Œåˆ†ç±»æ•°æ®æµã€‚ Kafka å…·æœ‰ä»¥ä¸‹ä¸»è¦ç»„ä»¶ï¼š Produc"><meta name=author content="wz"><link rel=canonical href=https://senmer.github.io/zh/posts/tech/kafka/kafka%E7%AE%80%E4%BB%8B%E4%B8%8E%E9%9B%86%E7%BE%A4%E9%83%A8%E7%BD%B2/><link crossorigin=anonymous href=/assets/css/stylesheet.5a2b6d77cc78ad18bcb4914c5c639c7ce5ab55e956c461d4310747892b3f50c2.css integrity="sha256-Wittd8x4rRi8tJFMXGOcfOWrVelWxGHUMQdHiSs/UMI=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script><link rel=icon href=https://senmer.github.io/img/Q.gif><link rel=icon type=image/png sizes=16x16 href=https://senmer.github.io/img/Q.gif><link rel=icon type=image/png sizes=32x32 href=https://senmer.github.io/img/Q.gif><link rel=apple-touch-icon href=https://senmer.github.io/img/Q.gif><link rel=mask-icon href=https://senmer.github.io/img/Q.gif><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script defer src=https://unpkg.com/mermaid@8.8.1/dist/mermaid.min.js></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css><script src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script><script src=https://cdn.jsdelivr.net/npm/jquery@3.6.3/dist/jquery.min.js></script><script>var _hmt=_hmt||[];(function(){var e,t=document.createElement("script");t.src="https://hm.baidu.com/hm.js?4d7c4710a089d70b71310f0e1ec7681b",e=document.getElementsByTagName("script")[0],e.parentNode.insertBefore(t,e)})()</script><meta property="og:title" content="Kafkaç®€ä»‹ä¸é›†ç¾¤éƒ¨ç½²"><meta property="og:description" content="ä¸€ã€Kafka ç®€ä»‹ï¼š Apache Kafka æ˜¯ä¸€ä¸ªå¼€æºçš„åˆ†å¸ƒå¼äº‹ä»¶æµå¹³å°ï¼Œæœ€åˆç”± LinkedIn å¼€å‘ï¼Œåæ¥æˆä¸º Apache è½¯ä»¶åŸºé‡‘ä¼šçš„é¡¶çº§é¡¹ç›®ã€‚å®ƒä¸»è¦ç”¨äºå¤„ç†å®æ—¶æ•°æ®æµï¼Œå°†æ•°æ®ä»ä¸€ä¸ªåœ°æ–¹ä¼ è¾“åˆ°å¦ä¸€ä¸ªåœ°æ–¹ã€‚Kafka çš„è®¾è®¡ç†å¿µæ˜¯åŸºäºå‘å¸ƒè®¢é˜…æ¨¡å‹ï¼Œé€šè¿‡ä½¿ç”¨ä¸»é¢˜ï¼ˆtopicsï¼‰æ¥ç»„ç»‡å’Œåˆ†ç±»æ•°æ®æµã€‚ Kafka å…·æœ‰ä»¥ä¸‹ä¸»è¦ç»„ä»¶ï¼š Produc"><meta property="og:type" content="article"><meta property="og:url" content="https://senmer.github.io/zh/posts/tech/kafka/kafka%E7%AE%80%E4%BB%8B%E4%B8%8E%E9%9B%86%E7%BE%A4%E9%83%A8%E7%BD%B2/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-09-01T10:26:01+08:00"><meta property="article:modified_time" content="2023-09-01T10:26:01+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Kafkaç®€ä»‹ä¸é›†ç¾¤éƒ¨ç½²"><meta name=twitter:description content="ä¸€ã€Kafka ç®€ä»‹ï¼š Apache Kafka æ˜¯ä¸€ä¸ªå¼€æºçš„åˆ†å¸ƒå¼äº‹ä»¶æµå¹³å°ï¼Œæœ€åˆç”± LinkedIn å¼€å‘ï¼Œåæ¥æˆä¸º Apache è½¯ä»¶åŸºé‡‘ä¼šçš„é¡¶çº§é¡¹ç›®ã€‚å®ƒä¸»è¦ç”¨äºå¤„ç†å®æ—¶æ•°æ®æµï¼Œå°†æ•°æ®ä»ä¸€ä¸ªåœ°æ–¹ä¼ è¾“åˆ°å¦ä¸€ä¸ªåœ°æ–¹ã€‚Kafka çš„è®¾è®¡ç†å¿µæ˜¯åŸºäºå‘å¸ƒè®¢é˜…æ¨¡å‹ï¼Œé€šè¿‡ä½¿ç”¨ä¸»é¢˜ï¼ˆtopicsï¼‰æ¥ç»„ç»‡å’Œåˆ†ç±»æ•°æ®æµã€‚ Kafka å…·æœ‰ä»¥ä¸‹ä¸»è¦ç»„ä»¶ï¼š Produc"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"ğŸ“šæ–‡ç« ","item":"https://senmer.github.io/zh/posts/"},{"@type":"ListItem","position":2,"name":"ğŸ‘¨ğŸ»â€ğŸ’» æŠ€æœ¯","item":"https://senmer.github.io/zh/posts/tech/"},{"@type":"ListItem","position":3,"name":"Kafkaç®€ä»‹ä¸é›†ç¾¤éƒ¨ç½²","item":"https://senmer.github.io/zh/posts/tech/kafka/kafka%E7%AE%80%E4%BB%8B%E4%B8%8E%E9%9B%86%E7%BE%A4%E9%83%A8%E7%BD%B2/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Kafkaç®€ä»‹ä¸é›†ç¾¤éƒ¨ç½²","name":"Kafkaç®€ä»‹ä¸é›†ç¾¤éƒ¨ç½²","description":"ä¸€ã€Kafka ç®€ä»‹ï¼š Apache Kafka æ˜¯ä¸€ä¸ªå¼€æºçš„åˆ†å¸ƒå¼äº‹ä»¶æµå¹³å°ï¼Œæœ€åˆç”± LinkedIn å¼€å‘ï¼Œåæ¥æˆä¸º Apache è½¯ä»¶åŸºé‡‘ä¼šçš„é¡¶çº§é¡¹ç›®ã€‚å®ƒä¸»è¦ç”¨äºå¤„ç†å®æ—¶æ•°æ®æµï¼Œå°†æ•°æ®ä»ä¸€ä¸ªåœ°æ–¹ä¼ è¾“åˆ°å¦ä¸€ä¸ªåœ°æ–¹ã€‚Kafka çš„è®¾è®¡ç†å¿µæ˜¯åŸºäºå‘å¸ƒè®¢é˜…æ¨¡å‹ï¼Œé€šè¿‡ä½¿ç”¨ä¸»é¢˜ï¼ˆtopicsï¼‰æ¥ç»„ç»‡å’Œåˆ†ç±»æ•°æ®æµã€‚ Kafka å…·æœ‰ä»¥ä¸‹ä¸»è¦ç»„ä»¶ï¼š Produc","keywords":[""],"articleBody":"ä¸€ã€Kafka ç®€ä»‹ï¼š Apache Kafka æ˜¯ä¸€ä¸ªå¼€æºçš„åˆ†å¸ƒå¼äº‹ä»¶æµå¹³å°ï¼Œæœ€åˆç”± LinkedIn å¼€å‘ï¼Œåæ¥æˆä¸º Apache è½¯ä»¶åŸºé‡‘ä¼šçš„é¡¶çº§é¡¹ç›®ã€‚å®ƒä¸»è¦ç”¨äºå¤„ç†å®æ—¶æ•°æ®æµï¼Œå°†æ•°æ®ä»ä¸€ä¸ªåœ°æ–¹ä¼ è¾“åˆ°å¦ä¸€ä¸ªåœ°æ–¹ã€‚Kafka çš„è®¾è®¡ç†å¿µæ˜¯åŸºäºå‘å¸ƒè®¢é˜…æ¨¡å‹ï¼Œé€šè¿‡ä½¿ç”¨ä¸»é¢˜ï¼ˆtopicsï¼‰æ¥ç»„ç»‡å’Œåˆ†ç±»æ•°æ®æµã€‚\nKafka å…·æœ‰ä»¥ä¸‹ä¸»è¦ç»„ä»¶ï¼š\nProducerï¼ˆç”Ÿäº§è€…ï¼‰ï¼š ç”¨äºå°†æ•°æ®å‘å¸ƒåˆ° Kafka ä¸»é¢˜ï¼Œè¿™äº›æ•°æ®å¯ä»¥æ˜¯æ—¥å¿—ã€äº‹ä»¶ã€æŒ‡æ ‡ç­‰ã€‚\nBrokerï¼š Kafka é›†ç¾¤ç”±å¤šä¸ª Broker ç»„æˆï¼Œæ¯ä¸ª Broker æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„æœåŠ¡å™¨ï¼Œè´Ÿè´£å­˜å‚¨æ•°æ®å’Œå¤„ç†æ•°æ®æµã€‚\nTopicï¼ˆä¸»é¢˜ï¼‰ï¼š æ•°æ®æµè¢«ç»„ç»‡æˆä¸»é¢˜ï¼Œç”Ÿäº§è€…å°†æ•°æ®å‘å¸ƒåˆ°ä¸»é¢˜ï¼Œæ¶ˆè´¹è€…ä»ä¸»é¢˜è®¢é˜…æ•°æ®ã€‚\nConsumerï¼ˆæ¶ˆè´¹è€…ï¼‰ï¼š æ¶ˆè´¹è€…ä»ä¸»é¢˜è®¢é˜…æ•°æ®ï¼Œå¹¶è¿›è¡Œç›¸åº”çš„å¤„ç†ã€‚æ¶ˆè´¹è€…å¯ä»¥ä»¥ä¸åŒçš„æ¶ˆè´¹ç»„ï¼ˆConsumer Groupï¼‰æ¥ç»„ç»‡ï¼Œä»¥å®ç°æ°´å¹³æ‰©å±•å’Œå¹¶è¡Œå¤„ç†ã€‚\nZookeeperï¼š è™½ç„¶ Kafka ä» 0.10 ç‰ˆæœ¬å¼€å§‹é€æ­¥å‡å°‘å¯¹ Zookeeper çš„ä¾èµ–ï¼Œä½†åœ¨ä¹‹å‰çš„ç‰ˆæœ¬ä¸­ï¼ŒZookeeper ç”¨äºç®¡ç† Kafka é›†ç¾¤çš„å…ƒæ•°æ®å’ŒçŠ¶æ€ã€‚\näºŒã€Kafka ä½¿ç”¨åœºæ™¯ï¼š å®æ—¶æ•°æ®æµå¤„ç†ï¼š Kafka å¯ä»¥ç”¨äºæ„å»ºå®æ—¶æ•°æ®æµå¤„ç†å¹³å°ï¼Œç”¨äºæ”¶é›†ã€ä¼ è¾“å’Œå¤„ç†å¤§é‡çš„å®æ—¶æ•°æ®ï¼Œå¦‚æ—¥å¿—ã€äº‹ä»¶ã€ä¼ æ„Ÿå™¨æ•°æ®ç­‰ã€‚\næ—¥å¿—æ”¶é›†å’Œåˆ†æï¼š å¾ˆå¤šç»„ç»‡ä½¿ç”¨ Kafka æ¥æ”¶é›†åˆ†å¸ƒåœ¨ä¸åŒç³»ç»Ÿä¸Šçš„æ—¥å¿—æ•°æ®ï¼Œå¹¶å°†å…¶ä¼ è¾“åˆ°é›†ä¸­çš„å­˜å‚¨æˆ–åˆ†æç³»ç»Ÿä¸­ã€‚\näº‹ä»¶é©±åŠ¨æ¶æ„ï¼š Kafka å¯ä»¥ä½œä¸ºäº‹ä»¶é©±åŠ¨æ¶æ„çš„æ ¸å¿ƒï¼Œä¸åŒçš„æœåŠ¡å¯ä»¥é€šè¿‡å‘å¸ƒå’Œè®¢é˜…äº‹ä»¶æ¥å®ç°è§£è€¦å’Œæ‰©å±•ã€‚\næŒ‡æ ‡å’Œç›‘æ§æ•°æ®ä¼ è¾“ï¼š Kafka å¯ä»¥ç”¨äºä¼ è¾“å„ç§ç³»ç»ŸæŒ‡æ ‡å’Œç›‘æ§æ•°æ®ï¼Œä»¥ä¾¿è¿›è¡Œå®æ—¶ç›‘æ§å’Œåˆ†æã€‚\næµå¼ ETLï¼ˆExtract, Transform, Loadï¼‰ï¼š Kafka å¯ä»¥ç”¨ä½œæ•°æ®æºå’Œæ•°æ®ç›®æ ‡ï¼Œæ”¯æŒæµå¼ ETL è¿‡ç¨‹ï¼Œä½¿æ•°æ®åœ¨ä¸åŒç³»ç»Ÿä¹‹é—´æµåŠ¨å’Œè½¬æ¢ã€‚\næ¶ˆæ¯é˜Ÿåˆ—ï¼š Kafka å¯ä»¥ä½œä¸ºé«˜ååé‡çš„æ¶ˆæ¯é˜Ÿåˆ—ï¼Œç”¨äºåœ¨ä¸åŒçš„åº”ç”¨ç¨‹åºå’ŒæœåŠ¡ä¹‹é—´ä¼ é€’æ¶ˆæ¯ã€‚\næ—¥å¿—å‹ç¼©å­˜å‚¨ï¼š Kafka å¯ä»¥ç”¨äºé•¿æœŸå­˜å‚¨æ•°æ®ï¼Œæ¯”å¦‚ä¿å­˜å†å²äº‹ä»¶å’Œæ•°æ®å¤‡ä»½ã€‚\næ€»ä¹‹ï¼ŒKafka åœ¨å¤„ç†å®æ—¶æ•°æ®æµã€æ„å»ºäº‹ä»¶é©±åŠ¨æ¶æ„ä»¥åŠå®ç°å¯é çš„æ•°æ®ä¼ è¾“æ–¹é¢å…·æœ‰å¹¿æ³›çš„åº”ç”¨åœºæ™¯ã€‚å®ƒçš„é«˜ååé‡ã€å¯æ‰©å±•æ€§å’ŒæŒä¹…æ€§ç‰¹å¾ä½¿å…¶æˆä¸ºè®¸å¤šå®æ—¶åº”ç”¨å’Œå¤§æ•°æ®å¤„ç†åœºæ™¯çš„ç†æƒ³é€‰æ‹©ã€‚\nä¸‰ã€Kafka é›†ç¾¤éƒ¨ç½² 3.1 å®éªŒç¯å¢ƒ æ³¨æ„ï¼šä»¥ä¸‹ä¸‰ä¸ªèŠ‚ç‚¹å·²ç»æå‰éƒ¨ç½²äº† zookeeper é›†ç¾¤ï¼ˆKafka é›†ç¾¤ä¾èµ– zookeeper ï¼‰\nä¸»æœºå IP ç³»ç»Ÿ é…ç½® kafka-01 10.0.0.11 CentOS 7.6 1U 2G kafka-02 10.0.0.12 CentOS 7.6 1U 2G kafka-03 10.0.0.13 CentOS 7.6 1U 2G 3.2 é…ç½® Java ç¯å¢ƒ æ‰€æœ‰èŠ‚ç‚¹æ‰§è¡Œï¼š\nyum install java-1.8.0-openjdk -y java -version 3.3 ä¸‹è½½å¹¶è§£å‹å®‰è£…åŒ… ä¸‹è½½åœ°å€ï¼šApache Kafka\næ‰€æœ‰èŠ‚ç‚¹æ‰§è¡Œï¼š\ncd /usr/local/src wget https://archive.apache.org/dist/kafka/2.1.0/kafka_2.12-2.1.0.tgz tar xf kafka_2.12-2.1.0.tgz ln -sv /usr/local/src/kafka_2.12-2.1.0 /usr/local/kafka cd /usr/local/kafka/ # æ ¹æ®éœ€è¦ä¿®æ”¹é…ç½®æ–‡ä»¶ cat \u003e config/server.properties \u003c\u003c EOF broker.id=0 num.network.threads=3 num.io.threads=8 socket.send.buffer.bytes=102400 socket.receive.buffer.bytes=102400 socket.request.max.bytes=104857600 log.dirs=/usr/local/kafka/kafka-logs num.partitions=1 num.recovery.threads.per.data.dir=1 offsets.topic.replication.factor=1 transaction.state.log.replication.factor=1 transaction.state.log.min.isr=1 log.retention.hours=168 log.segment.bytes=1073741824 log.retention.check.interval.ms=300000 zookeeper.connect=localhost:2181 zookeeper.connection.timeout.ms=6000 group.initial.rebalance.delay.ms=0 EOF å‚æ•°è§£é‡Šï¼š\nè¿™æ˜¯ä¸€ä¸ª Kafka Broker çš„é…ç½®ç¤ºä¾‹ï¼Œå…¶ä¸­åŒ…å«äº†ä¸€äº›å¸¸è§çš„é…ç½®é¡¹ã€‚ä¸‹é¢é€ä¸€è§£é‡Šæ¯ä¸ªé…ç½®é¡¹çš„å«ä¹‰ï¼š\nbroker.id=0ï¼š è®¾ç½® Broker çš„å”¯ä¸€æ ‡è¯†ç¬¦ã€‚åœ¨ä¸€ä¸ª Kafka é›†ç¾¤ä¸­ï¼Œæ¯ä¸ª Broker éƒ½åº”è¯¥æœ‰ä¸€ä¸ªç‹¬ä¸€æ— äºŒçš„ IDã€‚ num.network.threads=3ï¼š æŒ‡å®šå¤„ç†ç½‘ç»œè¯·æ±‚çš„çº¿ç¨‹æ•°ï¼Œç”¨äºæ¥æ”¶å’Œå¤„ç†å®¢æˆ·ç«¯è¿æ¥å’Œè¯·æ±‚ã€‚ num.io.threads=8ï¼š æŒ‡å®šæ‰§è¡Œ I/O æ“ä½œçš„çº¿ç¨‹æ•°ï¼Œç”¨äºå¤„ç†ç£ç›˜è¯»å†™ç­‰æ“ä½œã€‚ socket.send.buffer.bytes=102400ï¼š è®¾ç½®å¥—æ¥å­—å‘é€ç¼“å†²åŒºçš„å¤§å°ï¼Œä»¥å­—èŠ‚ä¸ºå•ä½ã€‚ socket.receive.buffer.bytes=102400ï¼š è®¾ç½®å¥—æ¥å­—æ¥æ”¶ç¼“å†²åŒºçš„å¤§å°ï¼Œä»¥å­—èŠ‚ä¸ºå•ä½ã€‚ socket.request.max.bytes=104857600ï¼š è®¾ç½®å•ä¸ªè¯·æ±‚çš„æœ€å¤§å­—èŠ‚æ•°ï¼Œç”¨äºé™åˆ¶å•ä¸ªè¯·æ±‚çš„å¤§å°ã€‚ log.dirs=/usr/local/kafka/kafka-logsï¼š æŒ‡å®š Kafka æ—¥å¿—æ–‡ä»¶çš„å­˜å‚¨è·¯å¾„ã€‚Kafka ä¼šå°†ä¸»é¢˜æ•°æ®ä»¥æ—¥å¿—æ–‡ä»¶çš„å½¢å¼å­˜å‚¨åœ¨è¿™äº›ç›®å½•ä¸‹ã€‚ num.partitions=1ï¼š è®¾ç½®é»˜è®¤ä¸»é¢˜çš„åˆ†åŒºæ•°ã€‚æ¯ä¸ªä¸»é¢˜å¯ä»¥è¢«åˆ†ä¸ºå¤šä¸ªåˆ†åŒºï¼Œè¿™ä¸ªé…ç½®é¡¹å®šä¹‰äº†æ–°å»ºä¸»é¢˜æ—¶çš„é»˜è®¤åˆ†åŒºæ•°ã€‚ num.recovery.threads.per.data.dir=1ï¼š æŒ‡å®šåœ¨æ¯ä¸ªæ•°æ®ç›®å½•ä¸Šè¿è¡Œçš„æ¢å¤çº¿ç¨‹æ•°ï¼Œç”¨äºåœ¨ Broker å¯åŠ¨æ—¶è¿›è¡Œæ•°æ®æ¢å¤ã€‚ offsets.topic.replication.factor=1ï¼š è®¾ç½®å­˜å‚¨æ¶ˆè´¹è€…åç§»é‡ä¿¡æ¯çš„å†…éƒ¨ä¸»é¢˜çš„å¤åˆ¶å› å­ã€‚è¿™ä¸ªå€¼å®šä¹‰äº†åç§»é‡ä¿¡æ¯çš„å†—ä½™å¤‡ä»½æ•°ã€‚ transaction.state.log.replication.factor=1ï¼š è®¾ç½®å­˜å‚¨äº‹åŠ¡çŠ¶æ€çš„å†…éƒ¨ä¸»é¢˜çš„å¤åˆ¶å› å­ã€‚ transaction.state.log.min.isr=1ï¼š è®¾ç½®äº‹åŠ¡çŠ¶æ€æ—¥å¿—çš„æœ€å°å‰¯æœ¬åŒæ­¥æ•°ã€‚å¦‚æœå¯ç”¨çš„å‰¯æœ¬æ•°é‡ä½äºè¿™ä¸ªå€¼ï¼Œå°±ä¸å…è®¸å†™å…¥äº‹åŠ¡çŠ¶æ€ã€‚ log.retention.hours=168ï¼š è®¾ç½®æ—¥å¿—æ–‡ä»¶çš„ä¿ç•™æ—¶é—´ï¼Œä»¥å°æ—¶ä¸ºå•ä½ã€‚è¶…è¿‡è¿™ä¸ªæ—¶é—´çš„æ—¥å¿—æ–‡ä»¶å°†è¢«è‡ªåŠ¨åˆ é™¤ã€‚ log.segment.bytes=1073741824ï¼š è®¾ç½®æ—¥å¿—æ®µï¼ˆlog segmentï¼‰çš„æœ€å¤§å¤§å°ï¼Œä»¥å­—èŠ‚ä¸ºå•ä½ã€‚ä¸€æ—¦æ—¥å¿—æ®µè¾¾åˆ°è¿™ä¸ªå¤§å°ï¼ŒKafka å°†åˆ›å»ºä¸€ä¸ªæ–°çš„æ—¥å¿—æ®µã€‚ log.retention.check.interval.ms=300000ï¼š è®¾ç½®æ—¥å¿—ä¿ç•™ç­–ç•¥çš„æ£€æŸ¥é—´éš”ï¼Œä»¥æ¯«ç§’ä¸ºå•ä½ã€‚Kafka å°†åœ¨è¿™ä¸ªæ—¶é—´é—´éš”å†…æ£€æŸ¥æ˜¯å¦éœ€è¦åˆ é™¤è¿‡æœŸçš„æ—¥å¿—æ–‡ä»¶ã€‚ zookeeper.connect=localhost:2181ï¼š æŒ‡å®š Zookeeper çš„è¿æ¥åœ°å€ï¼Œç”¨äºç®¡ç† Kafka é›†ç¾¤çš„å…ƒæ•°æ®å’ŒçŠ¶æ€ã€‚ zookeeper.connection.timeout.ms=6000ï¼š è®¾ç½®ä¸ Zookeeper çš„è¿æ¥è¶…æ—¶æ—¶é—´ï¼Œä»¥æ¯«ç§’ä¸ºå•ä½ã€‚ group.initial.rebalance.delay.ms=0ï¼š è®¾ç½®æ¶ˆè´¹è€…ç»„åˆå§‹å†å¹³è¡¡çš„å»¶è¿Ÿæ—¶é—´ï¼Œä»¥æ¯«ç§’ä¸ºå•ä½ã€‚è®¾ç½®ä¸º0è¡¨ç¤ºæ¶ˆè´¹è€…åŠ å…¥æ¶ˆè´¹è€…ç»„åç«‹å³è¿›è¡Œå†å¹³è¡¡ã€‚ è¿™äº›é…ç½®é¡¹æ˜¯ Kafka é›†ç¾¤ä¸­çš„ Broker éƒ¨åˆ†çš„é…ç½®ï¼Œå®ƒä»¬å¯ä»¥æ ¹æ®éœ€æ±‚è¿›è¡Œè°ƒæ•´ä»¥æ»¡è¶³æ€§èƒ½ã€å¯é æ€§å’Œèµ„æºç®¡ç†ç­‰æ–¹é¢çš„è¦æ±‚ã€‚\n3.3 ä¿®æ”¹é›†ç¾¤é…ç½® kafka-01 æ‰§è¡Œï¼š\n# é…ç½®é›†ç¾¤ ID sed -i 's/broker\\.id=0/broker\\.id=1/g' config/server.properties # ä¿®æ”¹æœåŠ¡ç›‘å¬åœ°å€ï¼Œé»˜è®¤æ˜¯localhost:9092 echo \"listeners=PLAINTEXT://10.0.0.11:9092\" \u003e\u003e config/server.properties kafka-02 æ‰§è¡Œï¼š\nsed -i 's/broker\\.id=0/broker\\.id=2/g' config/server.properties echo \"listeners=PLAINTEXT://10.0.0.12:9092\" \u003e\u003e config/server.properties kafka-03 æ‰§è¡Œï¼š\nsed -i 's/broker\\.id=0/broker\\.id=3/g' config/server.properties echo \"listeners=PLAINTEXT://10.0.0.13:9092\" \u003e\u003e config/server.properties 3.4 å¯åŠ¨æœåŠ¡ zookeeper-01 æ‰§è¡Œï¼š\n# å¯åŠ¨æœåŠ¡ cd /usr/local/kafka/ bin/kafka-server-start.sh -daemon config/server.properties #æŸ¥çœ‹ç«¯å£ [root@kafka-01 kafka]# ss -ntl | grep 9092 LISTEN 0 50 :::9092 :::* zookeeper-02 æ‰§è¡Œï¼š\ncd /usr/local/kafka/ bin/kafka-server-start.sh -daemon config/server.properties #æŸ¥çœ‹ç«¯å£ [root@kafka-01 kafka]# ss -ntl | grep 9092 LISTEN 0 50 :::9092 :::* zookeeper-03 æ‰§è¡Œï¼š\ncd /usr/local/kafka/ bin/kafka-server-start.sh -daemon config/server.properties #æŸ¥çœ‹ç«¯å£ [root@kafka-01 kafka]# ss -ntl | grep 9092 LISTEN 0 50 :::9092 :::* å››ã€Kafka æ•°æ®è¯»å†™ Kafkaè‡ªå¸¦äº†ä¸€äº›ç”¨äºæ“ä½œå’Œç®¡ç†Kafkaé›†ç¾¤çš„Shellè„šæœ¬ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸ç”¨çš„Kafkaè‡ªå¸¦Shellè„šæœ¬ç¤ºä¾‹ï¼š\n1. åˆ›å»ºä¸»é¢˜ï¼š\nä½¿ç”¨kafka-topics.shè„šæœ¬åˆ›å»ºä¸€ä¸ªåä¸º\"test-topic\"çš„ä¸»é¢˜ï¼Œå…·æœ‰3ä¸ªåˆ†åŒºå’Œ1ä¸ªå‰¯æœ¬ï¼š\n./kafka-topics.sh --create --topic test-topic --zookeeper localhost:2181 --partitions 3 --replication-factor 1 2. å‘é€æ¶ˆæ¯ï¼š\nä½¿ç”¨kafka-console-producer.shè„šæœ¬å‘é€æ¶ˆæ¯åˆ°\"test-topic\"ä¸»é¢˜ï¼š\n[root@kafka-01 bin]# ./kafka-console-producer.sh --topic test-topic --broker-list localhost:9092 OpenJDK 64-Bit Server VM warning: If the number of processors is expected to increase from one, then you should configure the number of parallel GC threads appropriately using -XX:ParallelGCThreads=N \u003ehello \u003eworld \u003eend \u003e^C 3. æ¥æ”¶æ¶ˆæ¯ï¼š\nä½¿ç”¨kafka-console-consumer.shè„šæœ¬ä»\"test-topic\"ä¸»é¢˜æ¶ˆè´¹æ¶ˆæ¯ï¼š\n[root@kafka-01 bin]# ./kafka-consoconsumer.sh --topic test-topic --bootstrap-server localhost:9092 --from-beginning OpenJDK 64-Bit Server VM warning: If the number of processors is expected to increase from one, then you should configure the number of parallel GC threads appropriately using -XX:ParallelGCThreads=N hello world end 4. æŸ¥çœ‹ä¸»é¢˜åˆ—è¡¨ï¼š\næŸ¥çœ‹å½“å‰Kafkaé›†ç¾¤ä¸­çš„ä¸»é¢˜åˆ—è¡¨ï¼š\n./kafka-topics.sh --list --zookeeper localhost:2181 5. æŸ¥çœ‹æ¶ˆè´¹è€…ç»„åˆ—è¡¨ï¼š\næŸ¥çœ‹å½“å‰æ¶ˆè´¹è€…ç»„çš„åˆ—è¡¨ï¼š\n./kafka-consumer-groups.sh --list --bootstrap-server localhost:9092 6. æè¿°ä¸»é¢˜ï¼š\nè·å–å…³äºä¸»é¢˜\"test-topic\"çš„ä¿¡æ¯ï¼Œå¦‚åˆ†åŒºå’Œå‰¯æœ¬åˆ†å¸ƒæƒ…å†µï¼š\n./kafka-topics.sh --describe --topic test-topic --zookeeper localhost:2181 7. æŸ¥çœ‹æ¶ˆè´¹è€…ç»„åç§»é‡ï¼š\næŸ¥çœ‹æ¶ˆè´¹è€…ç»„\"my-group\"åœ¨ä¸»é¢˜\"test-topic\"ä¸Šçš„æ¶ˆè´¹åç§»é‡ï¼š\n./kafka-consumer-groups.sh --describe --group my-group --bootstrap-server localhost:9092 å½“æ¶‰åŠåˆ é™¤ä¸»é¢˜å’Œåˆ›å»ºæ¶ˆè´¹è€…ç»„æ—¶ï¼Œä½ å¯ä»¥ä½¿ç”¨Kafkaè‡ªå¸¦çš„Shellè„šæœ¬æ¥æ‰§è¡Œè¿™äº›æ“ä½œã€‚ä»¥ä¸‹æ˜¯åˆ é™¤ä¸»é¢˜å’Œåˆ›å»ºæ¶ˆè´¹è€…ç»„çš„ç¤ºä¾‹ï¼š\n8. åˆ é™¤ä¸»é¢˜ï¼š\nä½¿ç”¨kafka-topics.shè„šæœ¬åˆ é™¤åä¸º\"test-topic\"çš„ä¸»é¢˜ï¼š\n./kafka-topics.sh --delete --topic test-topic --zookeeper localhost:2181 è¯·æ³¨æ„ï¼Œåˆ é™¤ä¸»é¢˜ä¼šæ°¸ä¹…åˆ é™¤è¯¥ä¸»é¢˜çš„æ‰€æœ‰æ•°æ®å’Œé…ç½®ï¼Œè¯·è°¨æ…æ“ä½œã€‚\n9. åˆ›å»ºæ¶ˆè´¹è€…ç»„ï¼š\nä½¿ç”¨kafka-consumer-groups.shè„šæœ¬åˆ›å»ºä¸€ä¸ªåä¸º\"my-consumer-group\"çš„æ¶ˆè´¹è€…ç»„ï¼Œå¹¶å°†å…¶è®¢é˜…åˆ°\"test-topic\"ä¸»é¢˜ï¼š\n./kafka-consumer-groups.sh --bootstrap-server localhost:9092 --create --topic test-topic --group my-consumer-group é™„å½• Kafka ä¸­æ–‡æ–‡æ¡£ - ApacheCN\nKafkaåŸºæœ¬åŸç†è¯¦è§£ï¼ˆè¶…è¯¦ç»†ï¼ï¼‰kafkaå·¥ä½œåŸç†\u003cä¸€è“‘çƒŸé›¨ä»»å¹³ç”Ÿ\u003eçš„åšå®¢-CSDNåšå®¢\nå­¦ä¹  Kafka å…¥é—¨çŸ¥è¯†çœ‹è¿™ä¸€ç¯‡å°±å¤Ÿäº†ï¼ï¼ˆä¸‡å­—é•¿æ–‡ï¼‰-è…¾è®¯äº‘å¼€å‘è€…ç¤¾åŒº-è…¾è®¯äº‘ (tencent.com)\nçœŸçš„ï¼Œææ‡‚ Kafka çœ‹è¿™ä¸€ç¯‡å°±å¤Ÿäº†ï¼ - æ˜é‡‘ (juejin.cn)\n","wordCount":"3352","inLanguage":"zh","datePublished":"2023-09-01T10:26:01+08:00","dateModified":"2023-09-01T10:26:01+08:00","author":[{"@type":"Person","name":"wz"}],"mainEntityOfPage":{"@type":"WebPage","@id":"https://senmer.github.io/zh/posts/tech/kafka/kafka%E7%AE%80%E4%BB%8B%E4%B8%8E%E9%9B%86%E7%BE%A4%E9%83%A8%E7%BD%B2/"},"publisher":{"@type":"Organization","name":"WZ's Blog","logo":{"@type":"ImageObject","url":"https://senmer.github.io/img/Q.gif"}}}</script></head><body id=top><script>(function(){let e,t=new RegExp("(^| )change-themes=([^;]*)(;|$)");(e=document.cookie.match(t))||((new Date).getHours()>=19||(new Date).getHours()<6?(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark")):(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")))})(),localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://senmer.github.io/zh/ accesskey=h title="WZ's Blog (Alt + H)"><img src=https://senmer.github.io/img/Q.gif alt=logo aria-label=logo height=35>WZ's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://senmer.github.io/zh/search title="ğŸ” æœç´¢ (Alt + /)" accesskey=/><span>ğŸ” æœç´¢</span></a></li><li><a href=https://senmer.github.io/zh/ title="ğŸ  ä¸»é¡µ"><span>ğŸ  ä¸»é¡µ</span></a></li><li><a href=https://senmer.github.io/zh/posts/tech title="ğŸ“š æ–‡ç« "><span>ğŸ“š æ–‡ç« </span></a></li><li><a href=https://senmer.github.io/zh/categories/ title="ğŸ§© åˆ†ç±»"><span>ğŸ§© åˆ†ç±»</span></a></li><li><a href=https://senmer.github.io/zh/archives/ title="â±ï¸ æ—¶é—´è½´"><span>â±ï¸ æ—¶é—´è½´</span></a></li><li><a href=https://senmer.github.io/zh/about title="ğŸ™‹ğŸ»â€â™‚ï¸ å…³äº"><span>ğŸ™‹ğŸ»â€â™‚ï¸ å…³äº</span></a></li><li><a href=https://senmer.github.io/zh/links title="ğŸ¤ å‹é“¾"><span>ğŸ¤ å‹é“¾</span></a></li></ul></nav></header><main class="main page"><style>i[id*=post_meta_style]{display:flex;align-items:center;margin:0 0 10px}</style><article class=post-single><div id=single-content><header class=post-header><div class=breadcrumbs><a href=https://senmer.github.io/zh/>ğŸ  ä¸»é¡µ</a>&nbsp;Â»&nbsp;<a href=https://senmer.github.io/zh/posts/>ğŸ“šæ–‡ç« </a>&nbsp;Â»&nbsp;<a href=https://senmer.github.io/zh/posts/tech/>ğŸ‘¨ğŸ»â€ğŸ’» æŠ€æœ¯</a></div><h1 class=post-title>Kafkaç®€ä»‹ä¸é›†ç¾¤éƒ¨ç½²</h1><div class=post-meta><style>i[id*=post_meta_style]{display:flex;align-items:center;margin:0 0 10px}.parent-post-meta{display:flex;flex-wrap:wrap;opacity:.8}</style><span class=parent-post-meta><span id=post_meta_style_1><span class="fa fa-calendar-check-o"></span>
<span>2023-09-01
&nbsp;&nbsp;
</span></span><span id=post_meta_style_3><span class="fa fa-file-word-o"></span>
<span>3352å­—
&nbsp;&nbsp;
</span></span><span id=post_meta_style_4><span class="fa fa-clock-o"></span>
<span>7åˆ†é’Ÿ
&nbsp;&nbsp;
</span></span><span id=post_meta_style_5><span class="fa fa-user-o"></span>
<span>wz
&nbsp;&nbsp;
</span></span><span id=post_meta_style_6><span class="fa fa-tags" style=opacity:.8></span>
<span><span class=post-tags-meta></span></span></span></span><span style=opacity:.8><span id=post_meta_style_7>&nbsp;&nbsp;
<span class="fa fa-eye"></span>
<span><span id=busuanzi_container_page_pv><span id=busuanzi_value_page_pv></span></span>
&nbsp;&nbsp;
</span></span><span id=post_meta_style_8><span class="fa fa-commenting-o"></span>
<span><script src=https://cdn.staticfile.org/twikoo/1.6.16/twikoo.all.min.js></script><script>let url=document.documentURI,dnsUrl="https://senmer.github.io/",urlSplit=url.split(dnsUrl),finalUrl=urlSplit[1];finalUrl[0]!=="/"&&(finalUrl="/"+finalUrl),twikoo.getCommentsCount({envId:"https://hugo-api-khaki.vercel.app/# å¡«å†™è‡ªå·±çš„twikoo id",region:null,urls:[finalUrl],includeReply:!1}).then(function(e){let t=e[0].count;const n=document.getElementById("comment_count");n.innerText=t}).catch(function(e){console.error(e)})</script><span id=comment_count></span></span></span></span></div></header><aside id=toc-container class="toc-container wide"><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>ç›®å½•</span></summary><div class=inner><ul><li><a href=#%e4%b8%80kafka-%e7%ae%80%e4%bb%8b aria-label="ä¸€ã€Kafka ç®€ä»‹ï¼š">ä¸€ã€Kafka ç®€ä»‹ï¼š</a></li><li><a href=#%e4%ba%8ckafka-%e4%bd%bf%e7%94%a8%e5%9c%ba%e6%99%af aria-label="äºŒã€Kafka ä½¿ç”¨åœºæ™¯ï¼š">äºŒã€Kafka ä½¿ç”¨åœºæ™¯ï¼š</a></li><li><a href=#%e4%b8%89kafka-%e9%9b%86%e7%be%a4%e9%83%a8%e7%bd%b2 aria-label="ä¸‰ã€Kafka é›†ç¾¤éƒ¨ç½²">ä¸‰ã€Kafka é›†ç¾¤éƒ¨ç½²</a><ul><li><a href=#31-%e5%ae%9e%e9%aa%8c%e7%8e%af%e5%a2%83 aria-label="3.1 å®éªŒç¯å¢ƒ">3.1 å®éªŒç¯å¢ƒ</a></li><li><a href=#32-%e9%85%8d%e7%bd%ae-java-%e7%8e%af%e5%a2%83 aria-label="3.2 é…ç½® Java ç¯å¢ƒ">3.2 é…ç½® Java ç¯å¢ƒ</a></li><li><a href=#33-%e4%b8%8b%e8%bd%bd%e5%b9%b6%e8%a7%a3%e5%8e%8b%e5%ae%89%e8%a3%85%e5%8c%85 aria-label="3.3 ä¸‹è½½å¹¶è§£å‹å®‰è£…åŒ…">3.3 ä¸‹è½½å¹¶è§£å‹å®‰è£…åŒ…</a></li><li><a href=#33-%e4%bf%ae%e6%94%b9%e9%9b%86%e7%be%a4%e9%85%8d%e7%bd%ae aria-label="3.3 ä¿®æ”¹é›†ç¾¤é…ç½®">3.3 ä¿®æ”¹é›†ç¾¤é…ç½®</a></li><li><a href=#34-%e5%90%af%e5%8a%a8%e6%9c%8d%e5%8a%a1 aria-label="3.4 å¯åŠ¨æœåŠ¡">3.4 å¯åŠ¨æœåŠ¡</a></li></ul></li><li><a href=#%e5%9b%9bkafka-%e6%95%b0%e6%8d%ae%e8%af%bb%e5%86%99 aria-label="å››ã€Kafka æ•°æ®è¯»å†™">å››ã€Kafka æ•°æ®è¯»å†™</a></li><li><a href=#%e9%99%84%e5%bd%95 aria-label=é™„å½•>é™„å½•</a></li></ul></div></details></div></aside><script>let activeElement,elements;window.addEventListener("DOMContentLoaded",function(){checkTocPosition(),elements=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]"),activeElement=elements[0];const t=encodeURI(activeElement.getAttribute("id")).toLowerCase();document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active")},!1),window.addEventListener("resize",function(){checkTocPosition()},!1),window.addEventListener("scroll",()=>{activeElement=Array.from(elements).find(e=>{if(getOffsetTop(e)-window.pageYOffset>0&&getOffsetTop(e)-window.pageYOffset<window.innerHeight/2)return e})||activeElement,elements.forEach(e=>{const t=encodeURI(e.getAttribute("id")).toLowerCase();e===activeElement?document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active"):document.querySelector(`.inner ul li a[href="#${t}"]`).classList.remove("active")})},!1);const main=parseInt(getComputedStyle(document.body).getPropertyValue("--article-width"),10),toc=parseInt(getComputedStyle(document.body).getPropertyValue("--toc-width"),10),gap=parseInt(getComputedStyle(document.body).getPropertyValue("--gap"),10);function checkTocPosition(){const e=document.body.scrollWidth;e-main-toc*2-gap*4>0?document.getElementById("toc-container").classList.add("wide"):document.getElementById("toc-container").classList.remove("wide")}function getOffsetTop(e){if(!e.getClientRects().length)return 0;let t=e.getBoundingClientRect(),n=e.ownerDocument.defaultView;return t.top+n.pageYOffset}</script><div class=post-content><h2 id=ä¸€kafka-ç®€ä»‹>ä¸€ã€Kafka ç®€ä»‹ï¼š<a hidden class=anchor aria-hidden=true href=#ä¸€kafka-ç®€ä»‹>#</a></h2><p>Apache Kafka æ˜¯ä¸€ä¸ªå¼€æºçš„åˆ†å¸ƒå¼äº‹ä»¶æµå¹³å°ï¼Œæœ€åˆç”± LinkedIn å¼€å‘ï¼Œåæ¥æˆä¸º Apache è½¯ä»¶åŸºé‡‘ä¼šçš„é¡¶çº§é¡¹ç›®ã€‚å®ƒä¸»è¦ç”¨äºå¤„ç†å®æ—¶æ•°æ®æµï¼Œå°†æ•°æ®ä»ä¸€ä¸ªåœ°æ–¹ä¼ è¾“åˆ°å¦ä¸€ä¸ªåœ°æ–¹ã€‚Kafka çš„è®¾è®¡ç†å¿µæ˜¯åŸºäºå‘å¸ƒè®¢é˜…æ¨¡å‹ï¼Œé€šè¿‡ä½¿ç”¨ä¸»é¢˜ï¼ˆtopicsï¼‰æ¥ç»„ç»‡å’Œåˆ†ç±»æ•°æ®æµã€‚</p><p>Kafka å…·æœ‰ä»¥ä¸‹ä¸»è¦ç»„ä»¶ï¼š</p><ol><li><p><strong>Producerï¼ˆç”Ÿäº§è€…ï¼‰ï¼š</strong> ç”¨äºå°†æ•°æ®å‘å¸ƒåˆ° Kafka ä¸»é¢˜ï¼Œè¿™äº›æ•°æ®å¯ä»¥æ˜¯æ—¥å¿—ã€äº‹ä»¶ã€æŒ‡æ ‡ç­‰ã€‚</p></li><li><p><strong>Brokerï¼š</strong> Kafka é›†ç¾¤ç”±å¤šä¸ª Broker ç»„æˆï¼Œæ¯ä¸ª Broker æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„æœåŠ¡å™¨ï¼Œè´Ÿè´£å­˜å‚¨æ•°æ®å’Œå¤„ç†æ•°æ®æµã€‚</p></li><li><p><strong>Topicï¼ˆä¸»é¢˜ï¼‰ï¼š</strong> æ•°æ®æµè¢«ç»„ç»‡æˆä¸»é¢˜ï¼Œç”Ÿäº§è€…å°†æ•°æ®å‘å¸ƒåˆ°ä¸»é¢˜ï¼Œæ¶ˆè´¹è€…ä»ä¸»é¢˜è®¢é˜…æ•°æ®ã€‚</p></li><li><p><strong>Consumerï¼ˆæ¶ˆè´¹è€…ï¼‰ï¼š</strong> æ¶ˆè´¹è€…ä»ä¸»é¢˜è®¢é˜…æ•°æ®ï¼Œå¹¶è¿›è¡Œç›¸åº”çš„å¤„ç†ã€‚æ¶ˆè´¹è€…å¯ä»¥ä»¥ä¸åŒçš„æ¶ˆè´¹ç»„ï¼ˆConsumer Groupï¼‰æ¥ç»„ç»‡ï¼Œä»¥å®ç°æ°´å¹³æ‰©å±•å’Œå¹¶è¡Œå¤„ç†ã€‚</p></li><li><p><strong>Zookeeperï¼š</strong> è™½ç„¶ Kafka ä» 0.10 ç‰ˆæœ¬å¼€å§‹é€æ­¥å‡å°‘å¯¹ Zookeeper çš„ä¾èµ–ï¼Œä½†åœ¨ä¹‹å‰çš„ç‰ˆæœ¬ä¸­ï¼ŒZookeeper ç”¨äºç®¡ç† Kafka é›†ç¾¤çš„å…ƒæ•°æ®å’ŒçŠ¶æ€ã€‚</p></li></ol><h2 id=äºŒkafka-ä½¿ç”¨åœºæ™¯>äºŒã€Kafka ä½¿ç”¨åœºæ™¯ï¼š<a hidden class=anchor aria-hidden=true href=#äºŒkafka-ä½¿ç”¨åœºæ™¯>#</a></h2><ol><li><p><strong>å®æ—¶æ•°æ®æµå¤„ç†ï¼š</strong> Kafka å¯ä»¥ç”¨äºæ„å»ºå®æ—¶æ•°æ®æµå¤„ç†å¹³å°ï¼Œç”¨äºæ”¶é›†ã€ä¼ è¾“å’Œå¤„ç†å¤§é‡çš„å®æ—¶æ•°æ®ï¼Œå¦‚æ—¥å¿—ã€äº‹ä»¶ã€ä¼ æ„Ÿå™¨æ•°æ®ç­‰ã€‚</p></li><li><p><strong>æ—¥å¿—æ”¶é›†å’Œåˆ†æï¼š</strong> å¾ˆå¤šç»„ç»‡ä½¿ç”¨ Kafka æ¥æ”¶é›†åˆ†å¸ƒåœ¨ä¸åŒç³»ç»Ÿä¸Šçš„æ—¥å¿—æ•°æ®ï¼Œå¹¶å°†å…¶ä¼ è¾“åˆ°é›†ä¸­çš„å­˜å‚¨æˆ–åˆ†æç³»ç»Ÿä¸­ã€‚</p></li><li><p><strong>äº‹ä»¶é©±åŠ¨æ¶æ„ï¼š</strong> Kafka å¯ä»¥ä½œä¸ºäº‹ä»¶é©±åŠ¨æ¶æ„çš„æ ¸å¿ƒï¼Œä¸åŒçš„æœåŠ¡å¯ä»¥é€šè¿‡å‘å¸ƒå’Œè®¢é˜…äº‹ä»¶æ¥å®ç°è§£è€¦å’Œæ‰©å±•ã€‚</p></li><li><p><strong>æŒ‡æ ‡å’Œç›‘æ§æ•°æ®ä¼ è¾“ï¼š</strong> Kafka å¯ä»¥ç”¨äºä¼ è¾“å„ç§ç³»ç»ŸæŒ‡æ ‡å’Œç›‘æ§æ•°æ®ï¼Œä»¥ä¾¿è¿›è¡Œå®æ—¶ç›‘æ§å’Œåˆ†æã€‚</p></li><li><p><strong>æµå¼ ETLï¼ˆExtract, Transform, Loadï¼‰ï¼š</strong> Kafka å¯ä»¥ç”¨ä½œæ•°æ®æºå’Œæ•°æ®ç›®æ ‡ï¼Œæ”¯æŒæµå¼ ETL è¿‡ç¨‹ï¼Œä½¿æ•°æ®åœ¨ä¸åŒç³»ç»Ÿä¹‹é—´æµåŠ¨å’Œè½¬æ¢ã€‚</p></li><li><p><strong>æ¶ˆæ¯é˜Ÿåˆ—ï¼š</strong> Kafka å¯ä»¥ä½œä¸ºé«˜ååé‡çš„æ¶ˆæ¯é˜Ÿåˆ—ï¼Œç”¨äºåœ¨ä¸åŒçš„åº”ç”¨ç¨‹åºå’ŒæœåŠ¡ä¹‹é—´ä¼ é€’æ¶ˆæ¯ã€‚</p></li><li><p><strong>æ—¥å¿—å‹ç¼©å­˜å‚¨ï¼š</strong> Kafka å¯ä»¥ç”¨äºé•¿æœŸå­˜å‚¨æ•°æ®ï¼Œæ¯”å¦‚ä¿å­˜å†å²äº‹ä»¶å’Œæ•°æ®å¤‡ä»½ã€‚</p></li></ol><p>æ€»ä¹‹ï¼ŒKafka åœ¨å¤„ç†å®æ—¶æ•°æ®æµã€æ„å»ºäº‹ä»¶é©±åŠ¨æ¶æ„ä»¥åŠå®ç°å¯é çš„æ•°æ®ä¼ è¾“æ–¹é¢å…·æœ‰å¹¿æ³›çš„åº”ç”¨åœºæ™¯ã€‚å®ƒçš„é«˜ååé‡ã€å¯æ‰©å±•æ€§å’ŒæŒä¹…æ€§ç‰¹å¾ä½¿å…¶æˆä¸ºè®¸å¤šå®æ—¶åº”ç”¨å’Œå¤§æ•°æ®å¤„ç†åœºæ™¯çš„ç†æƒ³é€‰æ‹©ã€‚</p><h2 id=ä¸‰kafka-é›†ç¾¤éƒ¨ç½²>ä¸‰ã€Kafka é›†ç¾¤éƒ¨ç½²<a hidden class=anchor aria-hidden=true href=#ä¸‰kafka-é›†ç¾¤éƒ¨ç½²>#</a></h2><h3 id=31-å®éªŒç¯å¢ƒ>3.1 å®éªŒç¯å¢ƒ<a hidden class=anchor aria-hidden=true href=#31-å®éªŒç¯å¢ƒ>#</a></h3><p><strong>æ³¨æ„ï¼šä»¥ä¸‹ä¸‰ä¸ªèŠ‚ç‚¹å·²ç»æå‰éƒ¨ç½²äº† zookeeper é›†ç¾¤</strong>ï¼ˆKafka é›†ç¾¤ä¾èµ– zookeeper ï¼‰</p><table><thead><tr><th>ä¸»æœºå</th><th>IP</th><th>ç³»ç»Ÿ</th><th>é…ç½®</th></tr></thead><tbody><tr><td>kafka-01</td><td>10.0.0.11</td><td>CentOS 7.6</td><td>1U 2G</td></tr><tr><td>kafka-02</td><td>10.0.0.12</td><td>CentOS 7.6</td><td>1U 2G</td></tr><tr><td>kafka-03</td><td>10.0.0.13</td><td>CentOS 7.6</td><td>1U 2G</td></tr></tbody></table><h3 id=32-é…ç½®-java-ç¯å¢ƒ>3.2 é…ç½® Java ç¯å¢ƒ<a hidden class=anchor aria-hidden=true href=#32-é…ç½®-java-ç¯å¢ƒ>#</a></h3><p><strong>æ‰€æœ‰èŠ‚ç‚¹æ‰§è¡Œï¼š</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>yum install java-1.8.0-openjdk -y
</span></span><span style=display:flex><span>java -version
</span></span></code></pre></div><h3 id=33-ä¸‹è½½å¹¶è§£å‹å®‰è£…åŒ…>3.3 ä¸‹è½½å¹¶è§£å‹å®‰è£…åŒ…<a hidden class=anchor aria-hidden=true href=#33-ä¸‹è½½å¹¶è§£å‹å®‰è£…åŒ…>#</a></h3><p><strong>ä¸‹è½½åœ°å€</strong>ï¼š<a href=https://kafka.apache.org/downloads>Apache Kafka</a></p><p><strong>æ‰€æœ‰èŠ‚ç‚¹æ‰§è¡Œï¼š</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cd /usr/local/src
</span></span><span style=display:flex><span>wget https://archive.apache.org/dist/kafka/2.1.0/kafka_2.12-2.1.0.tgz
</span></span><span style=display:flex><span>tar xf kafka_2.12-2.1.0.tgz
</span></span><span style=display:flex><span>ln -sv /usr/local/src/kafka_2.12-2.1.0 /usr/local/kafka
</span></span><span style=display:flex><span>cd /usr/local/kafka/
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># æ ¹æ®éœ€è¦ä¿®æ”¹é…ç½®æ–‡ä»¶</span>
</span></span><span style=display:flex><span>cat &gt; config/server.properties <span style=color:#e6db74>&lt;&lt; EOF
</span></span></span><span style=display:flex><span><span style=color:#e6db74>broker.id=0
</span></span></span><span style=display:flex><span><span style=color:#e6db74>num.network.threads=3
</span></span></span><span style=display:flex><span><span style=color:#e6db74>num.io.threads=8
</span></span></span><span style=display:flex><span><span style=color:#e6db74>socket.send.buffer.bytes=102400
</span></span></span><span style=display:flex><span><span style=color:#e6db74>socket.receive.buffer.bytes=102400
</span></span></span><span style=display:flex><span><span style=color:#e6db74>socket.request.max.bytes=104857600
</span></span></span><span style=display:flex><span><span style=color:#e6db74>log.dirs=/usr/local/kafka/kafka-logs
</span></span></span><span style=display:flex><span><span style=color:#e6db74>num.partitions=1
</span></span></span><span style=display:flex><span><span style=color:#e6db74>num.recovery.threads.per.data.dir=1
</span></span></span><span style=display:flex><span><span style=color:#e6db74>offsets.topic.replication.factor=1
</span></span></span><span style=display:flex><span><span style=color:#e6db74>transaction.state.log.replication.factor=1
</span></span></span><span style=display:flex><span><span style=color:#e6db74>transaction.state.log.min.isr=1
</span></span></span><span style=display:flex><span><span style=color:#e6db74>log.retention.hours=168
</span></span></span><span style=display:flex><span><span style=color:#e6db74>log.segment.bytes=1073741824
</span></span></span><span style=display:flex><span><span style=color:#e6db74>log.retention.check.interval.ms=300000
</span></span></span><span style=display:flex><span><span style=color:#e6db74>zookeeper.connect=localhost:2181
</span></span></span><span style=display:flex><span><span style=color:#e6db74>zookeeper.connection.timeout.ms=6000
</span></span></span><span style=display:flex><span><span style=color:#e6db74>group.initial.rebalance.delay.ms=0
</span></span></span><span style=display:flex><span><span style=color:#e6db74>EOF</span>
</span></span></code></pre></div><p><strong>å‚æ•°è§£é‡Šï¼š</strong></p><p>è¿™æ˜¯ä¸€ä¸ª Kafka Broker çš„é…ç½®ç¤ºä¾‹ï¼Œå…¶ä¸­åŒ…å«äº†ä¸€äº›å¸¸è§çš„é…ç½®é¡¹ã€‚ä¸‹é¢é€ä¸€è§£é‡Šæ¯ä¸ªé…ç½®é¡¹çš„å«ä¹‰ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ini data-lang=ini><span style=display:flex><span><span style=color:#a6e22e>broker.id</span><span style=color:#f92672>=</span><span style=color:#e6db74>0ï¼š è®¾ç½® Broker çš„å”¯ä¸€æ ‡è¯†ç¬¦ã€‚åœ¨ä¸€ä¸ª Kafka é›†ç¾¤ä¸­ï¼Œæ¯ä¸ª Broker éƒ½åº”è¯¥æœ‰ä¸€ä¸ªç‹¬ä¸€æ— äºŒçš„ IDã€‚</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>num.network.threads</span><span style=color:#f92672>=</span><span style=color:#e6db74>3ï¼š æŒ‡å®šå¤„ç†ç½‘ç»œè¯·æ±‚çš„çº¿ç¨‹æ•°ï¼Œç”¨äºæ¥æ”¶å’Œå¤„ç†å®¢æˆ·ç«¯è¿æ¥å’Œè¯·æ±‚ã€‚</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>num.io.threads</span><span style=color:#f92672>=</span><span style=color:#e6db74>8ï¼š æŒ‡å®šæ‰§è¡Œ I/O æ“ä½œçš„çº¿ç¨‹æ•°ï¼Œç”¨äºå¤„ç†ç£ç›˜è¯»å†™ç­‰æ“ä½œã€‚</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>socket.send.buffer.bytes</span><span style=color:#f92672>=</span><span style=color:#e6db74>102400ï¼š è®¾ç½®å¥—æ¥å­—å‘é€ç¼“å†²åŒºçš„å¤§å°ï¼Œä»¥å­—èŠ‚ä¸ºå•ä½ã€‚</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>socket.receive.buffer.bytes</span><span style=color:#f92672>=</span><span style=color:#e6db74>102400ï¼š è®¾ç½®å¥—æ¥å­—æ¥æ”¶ç¼“å†²åŒºçš„å¤§å°ï¼Œä»¥å­—èŠ‚ä¸ºå•ä½ã€‚</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>socket.request.max.bytes</span><span style=color:#f92672>=</span><span style=color:#e6db74>104857600ï¼š è®¾ç½®å•ä¸ªè¯·æ±‚çš„æœ€å¤§å­—èŠ‚æ•°ï¼Œç”¨äºé™åˆ¶å•ä¸ªè¯·æ±‚çš„å¤§å°ã€‚</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>log.dirs</span><span style=color:#f92672>=</span><span style=color:#e6db74>/usr/local/kafka/kafka-logsï¼š æŒ‡å®š Kafka æ—¥å¿—æ–‡ä»¶çš„å­˜å‚¨è·¯å¾„ã€‚Kafka ä¼šå°†ä¸»é¢˜æ•°æ®ä»¥æ—¥å¿—æ–‡ä»¶çš„å½¢å¼å­˜å‚¨åœ¨è¿™äº›ç›®å½•ä¸‹ã€‚</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>num.partitions</span><span style=color:#f92672>=</span><span style=color:#e6db74>1ï¼š è®¾ç½®é»˜è®¤ä¸»é¢˜çš„åˆ†åŒºæ•°ã€‚æ¯ä¸ªä¸»é¢˜å¯ä»¥è¢«åˆ†ä¸ºå¤šä¸ªåˆ†åŒºï¼Œè¿™ä¸ªé…ç½®é¡¹å®šä¹‰äº†æ–°å»ºä¸»é¢˜æ—¶çš„é»˜è®¤åˆ†åŒºæ•°ã€‚</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>num.recovery.threads.per.data.dir</span><span style=color:#f92672>=</span><span style=color:#e6db74>1ï¼š æŒ‡å®šåœ¨æ¯ä¸ªæ•°æ®ç›®å½•ä¸Šè¿è¡Œçš„æ¢å¤çº¿ç¨‹æ•°ï¼Œç”¨äºåœ¨ Broker å¯åŠ¨æ—¶è¿›è¡Œæ•°æ®æ¢å¤ã€‚</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>offsets.topic.replication.factor</span><span style=color:#f92672>=</span><span style=color:#e6db74>1ï¼š è®¾ç½®å­˜å‚¨æ¶ˆè´¹è€…åç§»é‡ä¿¡æ¯çš„å†…éƒ¨ä¸»é¢˜çš„å¤åˆ¶å› å­ã€‚è¿™ä¸ªå€¼å®šä¹‰äº†åç§»é‡ä¿¡æ¯çš„å†—ä½™å¤‡ä»½æ•°ã€‚</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>transaction.state.log.replication.factor</span><span style=color:#f92672>=</span><span style=color:#e6db74>1ï¼š è®¾ç½®å­˜å‚¨äº‹åŠ¡çŠ¶æ€çš„å†…éƒ¨ä¸»é¢˜çš„å¤åˆ¶å› å­ã€‚</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>transaction.state.log.min.isr</span><span style=color:#f92672>=</span><span style=color:#e6db74>1ï¼š è®¾ç½®äº‹åŠ¡çŠ¶æ€æ—¥å¿—çš„æœ€å°å‰¯æœ¬åŒæ­¥æ•°ã€‚å¦‚æœå¯ç”¨çš„å‰¯æœ¬æ•°é‡ä½äºè¿™ä¸ªå€¼ï¼Œå°±ä¸å…è®¸å†™å…¥äº‹åŠ¡çŠ¶æ€ã€‚</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>log.retention.hours</span><span style=color:#f92672>=</span><span style=color:#e6db74>168ï¼š è®¾ç½®æ—¥å¿—æ–‡ä»¶çš„ä¿ç•™æ—¶é—´ï¼Œä»¥å°æ—¶ä¸ºå•ä½ã€‚è¶…è¿‡è¿™ä¸ªæ—¶é—´çš„æ—¥å¿—æ–‡ä»¶å°†è¢«è‡ªåŠ¨åˆ é™¤ã€‚</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>log.segment.bytes</span><span style=color:#f92672>=</span><span style=color:#e6db74>1073741824ï¼š è®¾ç½®æ—¥å¿—æ®µï¼ˆlog segmentï¼‰çš„æœ€å¤§å¤§å°ï¼Œä»¥å­—èŠ‚ä¸ºå•ä½ã€‚ä¸€æ—¦æ—¥å¿—æ®µè¾¾åˆ°è¿™ä¸ªå¤§å°ï¼ŒKafka å°†åˆ›å»ºä¸€ä¸ªæ–°çš„æ—¥å¿—æ®µã€‚</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>log.retention.check.interval.ms</span><span style=color:#f92672>=</span><span style=color:#e6db74>300000ï¼š è®¾ç½®æ—¥å¿—ä¿ç•™ç­–ç•¥çš„æ£€æŸ¥é—´éš”ï¼Œä»¥æ¯«ç§’ä¸ºå•ä½ã€‚Kafka å°†åœ¨è¿™ä¸ªæ—¶é—´é—´éš”å†…æ£€æŸ¥æ˜¯å¦éœ€è¦åˆ é™¤è¿‡æœŸçš„æ—¥å¿—æ–‡ä»¶ã€‚</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>zookeeper.connect</span><span style=color:#f92672>=</span><span style=color:#e6db74>localhost:2181ï¼š æŒ‡å®š Zookeeper çš„è¿æ¥åœ°å€ï¼Œç”¨äºç®¡ç† Kafka é›†ç¾¤çš„å…ƒæ•°æ®å’ŒçŠ¶æ€ã€‚</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>zookeeper.connection.timeout.ms</span><span style=color:#f92672>=</span><span style=color:#e6db74>6000ï¼š è®¾ç½®ä¸ Zookeeper çš„è¿æ¥è¶…æ—¶æ—¶é—´ï¼Œä»¥æ¯«ç§’ä¸ºå•ä½ã€‚</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>group.initial.rebalance.delay.ms</span><span style=color:#f92672>=</span><span style=color:#e6db74>0ï¼š è®¾ç½®æ¶ˆè´¹è€…ç»„åˆå§‹å†å¹³è¡¡çš„å»¶è¿Ÿæ—¶é—´ï¼Œä»¥æ¯«ç§’ä¸ºå•ä½ã€‚è®¾ç½®ä¸º0è¡¨ç¤ºæ¶ˆè´¹è€…åŠ å…¥æ¶ˆè´¹è€…ç»„åç«‹å³è¿›è¡Œå†å¹³è¡¡ã€‚</span>
</span></span></code></pre></div><p>è¿™äº›é…ç½®é¡¹æ˜¯ Kafka é›†ç¾¤ä¸­çš„ Broker éƒ¨åˆ†çš„é…ç½®ï¼Œå®ƒä»¬å¯ä»¥æ ¹æ®éœ€æ±‚è¿›è¡Œè°ƒæ•´ä»¥æ»¡è¶³æ€§èƒ½ã€å¯é æ€§å’Œèµ„æºç®¡ç†ç­‰æ–¹é¢çš„è¦æ±‚ã€‚</p><h3 id=33-ä¿®æ”¹é›†ç¾¤é…ç½®>3.3 ä¿®æ”¹é›†ç¾¤é…ç½®<a hidden class=anchor aria-hidden=true href=#33-ä¿®æ”¹é›†ç¾¤é…ç½®>#</a></h3><p><strong>kafka-01 æ‰§è¡Œï¼š</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># é…ç½®é›†ç¾¤ ID</span>
</span></span><span style=display:flex><span>sed -i <span style=color:#e6db74>&#39;s/broker\.id=0/broker\.id=1/g&#39;</span> config/server.properties
</span></span><span style=display:flex><span><span style=color:#75715e># ä¿®æ”¹æœåŠ¡ç›‘å¬åœ°å€ï¼Œé»˜è®¤æ˜¯localhost:9092</span>
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34;listeners=PLAINTEXT://10.0.0.11:9092&#34;</span> &gt;&gt; config/server.properties
</span></span></code></pre></div><p><strong>kafka-02 æ‰§è¡Œï¼š</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sed -i <span style=color:#e6db74>&#39;s/broker\.id=0/broker\.id=2/g&#39;</span> config/server.properties
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34;listeners=PLAINTEXT://10.0.0.12:9092&#34;</span> &gt;&gt; config/server.properties
</span></span></code></pre></div><p><strong>kafka-03 æ‰§è¡Œï¼š</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sed -i <span style=color:#e6db74>&#39;s/broker\.id=0/broker\.id=3/g&#39;</span> config/server.properties
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34;listeners=PLAINTEXT://10.0.0.13:9092&#34;</span> &gt;&gt; config/server.properties
</span></span></code></pre></div><h3 id=34-å¯åŠ¨æœåŠ¡>3.4 å¯åŠ¨æœåŠ¡<a hidden class=anchor aria-hidden=true href=#34-å¯åŠ¨æœåŠ¡>#</a></h3><p><strong>zookeeper-01 æ‰§è¡Œï¼š</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># å¯åŠ¨æœåŠ¡</span>
</span></span><span style=display:flex><span>cd /usr/local/kafka/
</span></span><span style=display:flex><span>bin/kafka-server-start.sh -daemon config/server.properties
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#æŸ¥çœ‹ç«¯å£</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@kafka-01 kafka<span style=color:#f92672>]</span><span style=color:#75715e># ss -ntl | grep 9092</span>
</span></span><span style=display:flex><span>LISTEN     <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>50</span>          :::9092                    :::*
</span></span></code></pre></div><p><strong>zookeeper-02 æ‰§è¡Œï¼š</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cd /usr/local/kafka/
</span></span><span style=display:flex><span>bin/kafka-server-start.sh -daemon config/server.properties
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#æŸ¥çœ‹ç«¯å£</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@kafka-01 kafka<span style=color:#f92672>]</span><span style=color:#75715e># ss -ntl | grep 9092</span>
</span></span><span style=display:flex><span>LISTEN     <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>50</span>          :::9092                    :::*
</span></span></code></pre></div><p><strong>zookeeper-03 æ‰§è¡Œï¼š</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cd /usr/local/kafka/
</span></span><span style=display:flex><span>bin/kafka-server-start.sh -daemon config/server.properties
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#æŸ¥çœ‹ç«¯å£</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@kafka-01 kafka<span style=color:#f92672>]</span><span style=color:#75715e># ss -ntl | grep 9092</span>
</span></span><span style=display:flex><span>LISTEN     <span style=color:#ae81ff>0</span>      <span style=color:#ae81ff>50</span>          :::9092                    :::*
</span></span></code></pre></div><h2 id=å››kafka-æ•°æ®è¯»å†™>å››ã€Kafka æ•°æ®è¯»å†™<a hidden class=anchor aria-hidden=true href=#å››kafka-æ•°æ®è¯»å†™>#</a></h2><p>Kafkaè‡ªå¸¦äº†ä¸€äº›ç”¨äºæ“ä½œå’Œç®¡ç†Kafkaé›†ç¾¤çš„Shellè„šæœ¬ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸ç”¨çš„Kafkaè‡ªå¸¦Shellè„šæœ¬ç¤ºä¾‹ï¼š</p><p><strong>1. åˆ›å»ºä¸»é¢˜ï¼š</strong></p><p>ä½¿ç”¨<code>kafka-topics.sh</code>è„šæœ¬åˆ›å»ºä¸€ä¸ªåä¸º"test-topic"çš„ä¸»é¢˜ï¼Œå…·æœ‰3ä¸ªåˆ†åŒºå’Œ1ä¸ªå‰¯æœ¬ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./kafka-topics.sh --create --topic test-topic --zookeeper localhost:2181 --partitions <span style=color:#ae81ff>3</span> --replication-factor <span style=color:#ae81ff>1</span>
</span></span></code></pre></div><p><strong>2. å‘é€æ¶ˆæ¯ï¼š</strong></p><p>ä½¿ç”¨<code>kafka-console-producer.sh</code>è„šæœ¬å‘é€æ¶ˆæ¯åˆ°"test-topic"ä¸»é¢˜ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f92672>[</span>root@kafka-01 bin<span style=color:#f92672>]</span><span style=color:#75715e># ./kafka-console-producer.sh --topic test-topic --broker-list localhost:9092</span>
</span></span><span style=display:flex><span>OpenJDK 64-Bit Server VM warning: If the number of processors is expected to increase from one, <span style=color:#66d9ef>then</span> you should configure the number of parallel GC threads appropriately using -XX:ParallelGCThreads<span style=color:#f92672>=</span>N
</span></span><span style=display:flex><span>&gt;hello
</span></span><span style=display:flex><span>&gt;world      
</span></span><span style=display:flex><span>&gt;end
</span></span><span style=display:flex><span>&gt;^C
</span></span></code></pre></div><p><strong>3. æ¥æ”¶æ¶ˆæ¯ï¼š</strong></p><p>ä½¿ç”¨<code>kafka-console-consumer.sh</code>è„šæœ¬ä»"test-topic"ä¸»é¢˜æ¶ˆè´¹æ¶ˆæ¯ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f92672>[</span>root@kafka-01 bin<span style=color:#f92672>]</span><span style=color:#75715e># ./kafka-consoconsumer.sh --topic test-topic --bootstrap-server localhost:9092 --from-beginning</span>
</span></span><span style=display:flex><span>OpenJDK 64-Bit Server VM warning: If the number of processors is expected to increase from one, <span style=color:#66d9ef>then</span> you should configure the number of parallel GC threads appropriately using -XX:ParallelGCThreads<span style=color:#f92672>=</span>N
</span></span><span style=display:flex><span>hello
</span></span><span style=display:flex><span>world
</span></span><span style=display:flex><span>end
</span></span></code></pre></div><p><strong>4. æŸ¥çœ‹ä¸»é¢˜åˆ—è¡¨ï¼š</strong></p><p>æŸ¥çœ‹å½“å‰Kafkaé›†ç¾¤ä¸­çš„ä¸»é¢˜åˆ—è¡¨ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./kafka-topics.sh --list --zookeeper localhost:2181
</span></span></code></pre></div><p><strong>5. æŸ¥çœ‹æ¶ˆè´¹è€…ç»„åˆ—è¡¨ï¼š</strong></p><p>æŸ¥çœ‹å½“å‰æ¶ˆè´¹è€…ç»„çš„åˆ—è¡¨ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./kafka-consumer-groups.sh --list --bootstrap-server localhost:9092
</span></span></code></pre></div><p><strong>6. æè¿°ä¸»é¢˜ï¼š</strong></p><p>è·å–å…³äºä¸»é¢˜"test-topic"çš„ä¿¡æ¯ï¼Œå¦‚åˆ†åŒºå’Œå‰¯æœ¬åˆ†å¸ƒæƒ…å†µï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./kafka-topics.sh --describe --topic test-topic --zookeeper localhost:2181
</span></span></code></pre></div><p><strong>7. æŸ¥çœ‹æ¶ˆè´¹è€…ç»„åç§»é‡ï¼š</strong></p><p>æŸ¥çœ‹æ¶ˆè´¹è€…ç»„"my-group"åœ¨ä¸»é¢˜"test-topic"ä¸Šçš„æ¶ˆè´¹åç§»é‡ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./kafka-consumer-groups.sh --describe --group my-group --bootstrap-server localhost:9092
</span></span></code></pre></div><p>å½“æ¶‰åŠåˆ é™¤ä¸»é¢˜å’Œåˆ›å»ºæ¶ˆè´¹è€…ç»„æ—¶ï¼Œä½ å¯ä»¥ä½¿ç”¨Kafkaè‡ªå¸¦çš„Shellè„šæœ¬æ¥æ‰§è¡Œè¿™äº›æ“ä½œã€‚ä»¥ä¸‹æ˜¯åˆ é™¤ä¸»é¢˜å’Œåˆ›å»ºæ¶ˆè´¹è€…ç»„çš„ç¤ºä¾‹ï¼š</p><p><strong>8. åˆ é™¤ä¸»é¢˜ï¼š</strong></p><p>ä½¿ç”¨<code>kafka-topics.sh</code>è„šæœ¬åˆ é™¤åä¸º"test-topic"çš„ä¸»é¢˜ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./kafka-topics.sh --delete --topic test-topic --zookeeper localhost:2181
</span></span></code></pre></div><p>è¯·æ³¨æ„ï¼Œåˆ é™¤ä¸»é¢˜ä¼šæ°¸ä¹…åˆ é™¤è¯¥ä¸»é¢˜çš„æ‰€æœ‰æ•°æ®å’Œé…ç½®ï¼Œè¯·è°¨æ…æ“ä½œã€‚</p><p><strong>9. åˆ›å»ºæ¶ˆè´¹è€…ç»„ï¼š</strong></p><p>ä½¿ç”¨<code>kafka-consumer-groups.sh</code>è„šæœ¬åˆ›å»ºä¸€ä¸ªåä¸º"my-consumer-group"çš„æ¶ˆè´¹è€…ç»„ï¼Œå¹¶å°†å…¶è®¢é˜…åˆ°"test-topic"ä¸»é¢˜ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./kafka-consumer-groups.sh --bootstrap-server localhost:9092 --create --topic test-topic --group my-consumer-group
</span></span></code></pre></div><h2 id=é™„å½•>é™„å½•<a hidden class=anchor aria-hidden=true href=#é™„å½•>#</a></h2><p><a href=https://kafka.apachecn.org/>Kafka ä¸­æ–‡æ–‡æ¡£ - ApacheCN</a></p><p><a href=https://blog.csdn.net/weixin_45366499/article/details/106943229>KafkaåŸºæœ¬åŸç†è¯¦è§£ï¼ˆè¶…è¯¦ç»†ï¼ï¼‰<em>kafkaå·¥ä½œåŸç†</em>&lt;ä¸€è“‘çƒŸé›¨ä»»å¹³ç”Ÿ>çš„åšå®¢-CSDNåšå®¢</a></p><p><a href=https://cloud.tencent.com/developer/article/1547380>å­¦ä¹  Kafka å…¥é—¨çŸ¥è¯†çœ‹è¿™ä¸€ç¯‡å°±å¤Ÿäº†ï¼ï¼ˆä¸‡å­—é•¿æ–‡ï¼‰-è…¾è®¯äº‘å¼€å‘è€…ç¤¾åŒº-è…¾è®¯äº‘ (tencent.com)</a></p><p><a href=https://juejin.cn/post/6963101806402469902>çœŸçš„ï¼Œææ‡‚ Kafka çœ‹è¿™ä¸€ç¯‡å°±å¤Ÿäº†ï¼ - æ˜é‡‘ (juejin.cn)</a></p></div><div class=post-reward><div style=padding:0;margin:0;width:100%;font-size:16px;text-align:center><div id=QR style=opacity:0><div id=wechat style=display:inline-block><a class=fancybox rel=group><img id=wechat_qr src=https://senmer.github.io/img/wechat_pay.png alt=wechat_pay></a><p>å¾®ä¿¡</p></div><div id=alipay style=display:inline-block><a class=fancybox rel=group><img id=alipay_qr src=https://senmer.github.io/img/alipay.png alt=alipay></a><p>æ”¯ä»˜å®</p></div></div><button id=rewardButton onclick='var qr=document.getElementById("QR");qr.style.opacity==="0"?qr.style.opacity="1":qr.style.opacity="0"'>
<span>ğŸ§§ é¼“åŠ±</span></button></div></div><footer class=post-footer><nav class=paginav><a class=prev href=https://senmer.github.io/zh/posts/tech/kubernetes/kubeadm%E9%83%A8%E7%BD%B2k8s%E9%9B%86%E7%BE%A4/><span class=title>Â« ä¸Šä¸€é¡µ</span><br><span>Kubeadméƒ¨ç½²k8sé›†ç¾¤</span>
</a><a class=next href=https://senmer.github.io/zh/posts/tech/zookeeper/zookeeper/><span class=title>ä¸‹ä¸€é¡µ Â»</span><br><span>Zookeeper</span></a></nav></footer></div><style>.comments_details summary::marker{font-size:20px;content:'ğŸ‘‰å±•å¼€è¯„è®º';color:var(--content)}.comments_details[open] summary::marker{font-size:20px;content:'ğŸ‘‡å…³é—­è¯„è®º';color:var(--content)}</style><div><details class=comments_details open><summary style=display:none></summary><div id=tcomment></div></details><script src=https://cdn.staticfile.org/twikoo/1.6.16/twikoo.all.min.js></script><script>twikoo.init({envId:"https://hugo-api-khaki.vercel.app/# å¡«å†™è‡ªå·±çš„twikoo id",el:"#tcomment",lang:"zh-CN",region:null,path:window.TWIKOO_MAGIC_PATH||window.location.pathname})</script></div></article></main><footer class=footer><span>Copyright
&copy;
2020-2023
<a href=https://senmer.github.io/zh/ style=color:#939393>WZ's Blog</a>
All Rights Reserved
</span><a href=https://beian.miit.gov.cn/ target=_blank style=color:#939393></a>&nbsp;
<span><a target=_blank href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=null" style=display:inline-block;text-decoration:none;height:20px;color:#939393><img src style="float:left;margin:0 5px 0 0">
</a></span><span id=busuanzi_container><span class="fa fa-user"></span> <span id=busuanzi_value_site_uv></span>
<span class="fa fa-eye"></span> <span id=busuanzi_value_site_pv></span></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><span class=topInner><svg class="topSvg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg><span id=read_progress></span>
</span></a><script>document.addEventListener("scroll",function(){const t=document.getElementById("read_progress"),n=document.documentElement.scrollHeight,s=document.documentElement.clientHeight,o=document.documentElement.scrollTop||document.body.scrollTop;t.innerText=((o/(n-s)).toFixed(2)*100).toFixed(0)})</script><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>let mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>200||document.documentElement.scrollTop>200?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{(function(){document.cookie="change-themes="+escape("false")})(),document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.body.addEventListener("copy",function(e){if(window.getSelection().toString()&&window.getSelection().toString().length>50){let t=e.clipboardData||window.clipboardData;if(t){e.preventDefault();let n=window.getSelection().toString(),s=window.getSelection().toString();t.setData("text/html",n),t.setData("text/plain",s)}}})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const s=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerText="å¤åˆ¶";function i(){t.innerText="å·²å¤åˆ¶ï¼",setTimeout(()=>{t.innerText="å¤åˆ¶"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){let t=e.textContent;navigator.clipboard.writeText(t),i();return}const n=document.createRange();n.selectNodeContents(e);const s=window.getSelection();s.removeAllRanges(),s.addRange(n);try{document.execCommand("copy"),i()}catch{}s.removeRange(n)});let l=e.className.replaceAll("language-",""),n=document.createElement("div"),a=document.createElement("div"),r=document.createElement("div"),c=document.createElement("div"),o=document.createElement("div");o.innerText=l,n.setAttribute("class","mac-tool"),a.setAttribute("class","mac bb1"),r.setAttribute("class","mac bb2"),c.setAttribute("class","mac bb3"),o.setAttribute("class","language-type"),n.appendChild(a),n.appendChild(r),n.appendChild(c),n.appendChild(o),s.classList.contains("highlight")?(s.appendChild(t),s.appendChild(n)):s.parentNode.firstChild==s||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?(e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t),s.appendChild(n)):(e.parentNode.appendChild(t),s.appendChild(n)))})</script></body></html>